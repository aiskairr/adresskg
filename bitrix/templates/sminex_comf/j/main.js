"use strict";var core={win:null,html:null},lst=0,runstack=[],unloadstack=[],request_text="",request_data=[],ajax=!1;"undefined"!=typeof console&&void 0!==console.log||(console={log:function(){}}),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),window.getComputedStyle||(window.getComputedStyle=function(a,e){return this.el=a,this.getPropertyValue=function(e){var t=/(\-([a-z]){1})/g;return"float"==e&&(e="styleFloat"),t.test(e)&&(e=e.replace(t,function(){return arguments[2].toUpperCase()})),a.currentStyle[e]?a.currentStyle[e]:null},this}),function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),a}"function"!=typeof CustomEvent&&(e.prototype=window.Event.prototype,window.CustomEvent=e)}(),$(function(){var e,t;site.f.init(),console.log("init"),jQuery.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},t={},(e=jQuery.uaMatch(navigator.userAgent)).browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),jQuery.browser=t});var site={width:null,height:null,is_mobile:!1,is_tablet:!1,current_page:[],session:{},path:[],timeline_preload:null,bg_lazy_stop:!1};function detectIE(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(0<t)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(0<e.indexOf("Trident/")){var a=e.indexOf("rv:");return parseInt(e.substring(a+3,e.indexOf(".",a)),10)}var o=e.indexOf("Edge/");return 0<o&&parseInt(e.substring(o+5,e.indexOf(".",o)),10)}site.f={init:function(){if(void 0===core.content&&(core.content=$(".page-content")),void 0!==window.TweenMax&&"hidden"!=core.content.css("visibility")){core=$.extend(core,{win:$(window),doc:$(document),html:$("html"),body:$("body"),preloader:$(".preloader"),preload_content:$(".preload-content"),header:$(".page-header"),$pathway:$(".header-path"),$header_back:$(".header-back"),submenu:$(".submenu")}),site.width=core.win.width(),site.height=core.win.height(),site.is_mobile=core.html.hasClass("mobile"),site.is_tablet=core.html.hasClass("tablet"),site.f.initMenu(),site.f.initPreload(),site.f.initRouting(),site.f.updateMenu(window.location.href),$.isFunction(site.f.onload)&&site.f.onload();var e=document.querySelector(".form_feedback");null!==e&&new ValidateForm(e,"/ajax/forms/callorder.php");var t=document.querySelector(".form_subscribe");null!==t&&new ValidateForm(t,"/ajax/forms/subscribe.php");var z=document.querySelector(".form_comf");null!==z&&new ValidateForm(z,"/ajax/forms/comf.php");var a=document.querySelector(".form_vc");null!==a&&new ValidateForm(a,"/ajax/forms/vc.php"),site.f.unleashModals()}else setTimeout(site.f.init,50)},unleashModals:function(){document.body.addEventListener("click",function(e){var t="";if($(e.target).hasClass("modal__link")?t=$(e.target):0!==$(e.target).closest(".modal__link").length&&(t=$(e.target).closest(".modal__link")),""!==t){e.preventDefault();var a="";"A"===t.eq(0).prop("tagName")?!1!==(a=t.eq(0).attr("href").replace("#",""))&&""!==a&&document.getElementById(a).classList.add("modal_active"):!1!==(a=t.eq(0).attr("data-target"))&&""!==a&&document.querySelector('[data-modal="'+a+'"]').classList.add("modal_active")}else(e.target.classList.contains("modal__screen")||e.target.classList.contains("modal__closer"))&&document.querySelector(".modal_active").classList.remove("modal_active")})},onload:function(){$.isFunction(site.custom_loading)||window.scrollTo(0,0),$("a[name=popup]").click(function(e){e.preventDefault(),$($(this).attr("href")).modal(site.wnd_params)}),$(".bt-scroll-up").click(function(e){e.preventDefault(),core.html.velocity("scroll",{duration:600})}),$(".js-scroll-block-down").click(function(e){e.preventDefault();var t=$(this).closest(".block-image-text-anm,.block-fade-text-image").next();t.length&&t.velocity("scroll",{duration:400})}),$(".border-scroll-down").click(function(e){e.preventDefault();var t=$(this).closest(".page-intro").next();t.length&&t.velocity("scroll",{duration:400,offset:-50})}),$(".bt-scroll-down").click(function(e){e.preventDefault();var t=$(this).closest(".swiper-container");if(t.length)t[0].swiper.slideNext();else{var a=$(this).closest(".page-intro,.finishing-page-intro");a.length&&a.next().next().velocity("scroll",{duration:800,offset:-80})}}),core.body.on("click",".js-jump",function(e){e.preventDefault();var t=$('a[name="'+$(this).attr("href").replace("#","")+'"]');t.length&&TweenMax.to(window,.6,{scrollTo:{y:t.offset().top-core.header.height()}})}),core.$pathway.empty(),core.$header_back.find("a").text(""),"undefined"!=typeof pathway&&0<pathway.length&&($.each(pathway,function(){core.$pathway.append('<a href="'+this.url+'">'+this.name+'</a><svg><use xlink:href="#arrow-right-small-gr"></use></svg>')}),core.$pathway.find("svg:last-child").remove(),core.$header_back.find("a").text(pathway[pathway.length-1].name).attr("href",pathway[pathway.length-1].url)),void 0!==site.sm_controller&&site.sm_controller.destroy(),site.sm_controller=new ScrollMagic.Controller,$(".common-intro-arrow").each(function(){var e=new TimelineMax({repeat:-1}),t=$(this);e.fromTo(t.find(".line_"),.6,{drawSVG:"0% 100%"},{drawSVG:"0% 0%"},.3).fromTo(t.find(".arrow_"),.8,{drawSVG:"30% 60%",opacity:.5},{drawSVG:"0% 100%",opacity:1},.4).fromTo(t.find(".line_"),.2,{drawSVG:"50% 50%"},{drawSVG:"100% 0%"},"+=.6").fromTo(t.find(".arrow_"),.3,{drawSVG:"0% 100%",opacity:1},{drawSVG:"30% 60%",opacity:.5},"-=.2")}),$(".bt-play-video-anm").hover(function(){var e=$(this),t=e.find("svg"),a=e.find("circle");TweenMax.to(t,.4,{opacity:1}),TweenMax.set(a,{drawSVG:"0% 0%"}),TweenMax.to(a,.4,{drawSVG:"80% 100%"}),TweenMax.fromTo(t,1,{rotation:0},{rotation:360,repeat:-1,ease:Power0.easeNone})},function(){var e=$(this),t=e.find("svg"),a=e.find("circle");TweenMax.to(a,.4,{drawSVG:"100% 100%"}),TweenMax.to(t,.4,{rotation:540,opacity:0})}),$(".header-call").hover(function(){TweenMax.to("#ico-phone-message",.4,{transformOrigin:"50% 50%",scale:2.3,x:"-4%"}),TweenMax.fromTo("#ico-phone-phone",.4,{x:"0%",opacity:1},{x:"-150%",opacity:0})},function(){TweenMax.to("#ico-phone-message",.4,{transformOrigin:"50% 50%",scale:1}),TweenMax.fromTo("#ico-phone-phone",.4,{x:"150%",opacity:0},{x:"0%",opacity:1})}),$(".header-lk").hover(function(){TweenMax.fromTo("#header-lk-user",.4,{transformOrigin:"50% 50%",scale:1,opacity:1},{scale:.1,opacity:0}),TweenMax.fromTo("#header-lk-key",.4,{transformOrigin:"50% 21%",scale:1},{scale:.18})},function(){TweenMax.fromTo("#header-lk-user",.4,{transformOrigin:"50% 50%",scale:.1,opacity:0},{scale:1,opacity:1}),TweenMax.fromTo("#header-lk-key",.4,{transformOrigin:"50% 21%",scale:.18},{scale:1})})},jump:function(){var e=window.location.hash.replace("#","");e&&($('a[name="'+e+'"]').length&&TweenMax.to(window,.6,{scrollTo:'a[name="'+e+'"]'}))},beforeshow:function(){$(".loading-hidden").removeClass("loading-hidden")},aftershow:function(){site.f.jump(),site.f.bgLazyLoad()},bgLazyLoad:function(){console.log("bgLazyLoad"),site.bg_lazy_stop||$("[data-lazy-bg]").each(function(){var e=$(this),t=e.attr("data-lazy-bg");t&&e.css("background-image","url("+t+")").removeAttr("data-lazy-bg")})},parseReq:function(){var e=$("[data-preload]"),t=!1;if(e.length){var a=[];if(e.each(function(){a.push($(this).attr("data-preload"))}),a.length){var o=new createjs.LoadQueue;o.loadManifest(a),o.on("complete",i),t=!0}}function i(){var e=core.body.attr("class").replace(/  /g," ").split(" ");site.current_page=e;for(var t=0;t<e.length;t++)e[t]=e[t].replace(/\-/g,"_"),e[t].length<2||runstack[e[t]]||(site.f["init_"+e[t]]&&(runstack[e[t]]=!0,site.f["init_"+e[t]].apply()),void 0!==window["_"+e[t]]&&(runstack[e[t]]=!0,window["_"+e[t]].init()))}t||i()},initPreload:function(){site.loading=!0,"scrollRestoration"in history&&(history.scrollRestoration="manual"),site.timeline_preload||(site.timeline_preload=new TimelineMax({repeat:-1,repeatDelay:0,paused:!0,smoothChildTiming:!0,onRepeat:function(){site.loading||site.timeline_preload.pause()}}),site.timeline_preload.fromTo(".preloader-circular-path",.4,{drawSVG:"0% 0%"},{drawSVG:"20% 45%"}).fromTo(".preloader-circular-path",.8,{drawSVG:"20% 45%"},{drawSVG:"50% 80%"}).fromTo(".preloader-circular-path",.6,{drawSVG:"50% 80%"},{drawSVG:"100% 100%"}).fromTo(".preloader-circular",1.8,{rotationZ:"0deg",ease:Power0.easeNone},{rotationZ:"360deg"},0)),core.preloader.length&&(core.content.addClass("loading"),TweenMax.isTweening(".preloader-digits-line")||(TweenMax.fromTo(".preloader-digits",.6,{scale:.1,opacity:0},{scale:1,opacity:1}),TweenMax.fromTo(".preloader-digits-line",10,{y:16,ease:Expo.easeOut},{y:-131.2,onComplete:function(){site.loading&&TweenMax.to(".preloader-digits-line",14,{y:-155.2,ease:Power0.easeNone})}})),site.timeline_preload.isActive()||(site.timeline_preload.restart(),TweenMax.fromTo(".preloader-circular-path",.6,{attr:{"stroke-width":.1}},{attr:{"stroke-width":.5}}),TweenMax.fromTo(".preloader-circular",.6,{scale:1,opacity:0},{scale:1,opacity:1})),site.loading_int=setInterval(function(){site.loading||(clearInterval(site.loading_int),void 0!==site.loading_break_int&&clearTimeout(site.loading_break_int),site.f.removePreloader())},10),site.loading_break_int=setTimeout(function(){site.loading&&(site.loading=!1,clearInterval(site.loading_int),site.f.removePreloader())},35e3))},removePreloader:function(){var e=Math.max(core.win.width(),core.win.height());core.content.removeClass("loading"),$.isFunction(site.f.beforeshow)&&site.f.beforeshow();var t=core.preloader.removeClass("show_").css("background","none").addClass("hide_").find(".preloader-bg");site.timeline_preload.pause(),TweenMax.to(".preloader-circular-path",.2,{drawSVG:"0% 100%",attr:{"stroke-width":.1}}),TweenMax.to(".preloader-circular",.6,{rotationZ:"720deg",scale:6,opacity:0}),(new TimelineMax).to(".preloader-digits-line",.6,{y:-160,ease:Expo.easeOut}).fromTo(t,.6,{width:1.5*e,height:1.5*e,top:core.win.height()/2-1.5*e/2,left:core.win.width()/2-1.5*e/2,margin:0,borderWidth:1.5*e/2},{opacity:0,delay:.05,onComplete:function(){core.preloader.css("visibility","hidden"),$.isFunction(site.f.aftershow)&&site.f.aftershow()}}).to(".preloader-digits",.4,{opacity:0},.6)},initMenu:function(){var a;site.menu_items=core.header.find(".header-menu li.root-item");$(".submenu"),$(".header-menu");core.header.hover(function(){core.header.addClass("hover_")},function(){core.header.removeClass("hover_")}),site.menu_items.hover(function(){clearTimeout(a),core.header.addClass("hover_");var e=$(this),t=(e.position().left,e.width(),e.index(),e.find(".submenu"));$(".submenu.show_").removeClass("show_"),t.length&&(t.addClass("show_"),site.menu_items.removeClass("hover").children("a").removeClass("hover").end().filter(".root-item-selected").children("a").addClass("noselection"),e.addClass("hover").children("a").removeClass("noselection").addClass("hover"))},function(){var e=$(this);a=setTimeout(function(){$(".submenu.show_").removeClass("show_"),site.menu_items.filter(".hover").length||site.menu_items.filter(".root-item-selected").children("a").removeClass("noselection")},300),e.removeClass("hover").children("a").removeClass("hover")}),$(".bt-show-mainmenu").click(function(e){e.preventDefault();var t=$(this);if(t.toggleClass("close_"),t.hasClass("close_"))t.addClass("show_"),core.header.data("class",core.header.attr("class")),core.header.removeClass("menuhidden_ favorites_ menucommercial_ menuapartments_ menucommercial-sale_ menucommercial-rent_ headerpath_ roomsresult_ headerback_");else{t.removeClass("show_");var a=core.header.data("class");core.header.attr("class",a)}}),site.is_mobile&&$("li.root-item > a").click(function(e){return"/info/"!=$(this).attr("href")||(e.preventDefault(),!1)}),site.is_mobile||site.menu_items.find("a").click(function(){site.f.collapseMenu()})},expandMenu:function(){},collapseMenu:function(){var e=$(".submenu");$(".header-menu").find("li,a").removeClass("hover show_ noselection"),e.removeClass("show_"),core.header.removeClass("hover_")},initCallback:function(){},initRouting:function(){core.body.attr("class",$("#page-classes").attr("data-classes")),site.f.parseReq(),page("*",function(o,e){if(site.loading||core.preloader.find(".preloader-bg").hasClass("velocity-animating"))return!1;if(core.body.hasClass("authorized"))return e(),!1;site.loading=!0,site.f.collapseMenu(),void 0!==window.stop&&window.stop();var t=String("/"+o.canonicalPath+"/").replace(/\/\//g,"/").slice(1,-1).split("/");if(t.length){if(site.current_page.length)for(var a=0;a<site.current_page.length;a++)site.current_page[a]=site.current_page[a].replace(/\-/g,"_"),site.current_page[a].length<2||unloadstack[site.current_page[a]]||void 0!==window["_"+site.current_page[a]]&&$.isFunction(window["_"+site.current_page[a]].unload)&&(unloadstack[site.current_page[a]]=!0,window["_"+site.current_page[a]].unload());unloadstack=[],site.current_page=t,console.log(o.canonicalPath),site.f.updateMenu(o.canonicalPath),ajax=!0;var i=$.isFunction(site.custom_loading);setTimeout(function(){if(i){var e=site.custom_loading();setTimeout(function(){core.content.empty(),$.get(o.canonicalPath,{ajax:1},site.f.getAjaxContent)},e)}else{site.timeline_preload.isActive()||(site.timeline_preload.restart(),TweenMax.fromTo(".preloader-circular-path",.6,{attr:{"stroke-width":.1}},{attr:{"stroke-width":.5}}),TweenMax.fromTo(".preloader-circular",.6,{scale:1,opacity:0},{scale:1,opacity:1})),TweenMax.fromTo(".preloader-digits",.6,{scale:.1,opacity:0},{scale:1,opacity:1}),TweenMax.fromTo(".preloader-digits-line",10,{y:16,ease:Expo.easeOut},{y:-131.2,onComplete:function(){site.loading&&TweenMax.to(".preloader-digits-line",14,{y:-155.2,ease:Power0.easeNone})}});var t=Math.max(core.win.width(),core.win.height()),a=core.preloader.removeClass("immediately").css("visibility","visible").addClass("show_").removeClass("hide_").find(".preloader-bg");TweenMax.fromTo(a,.8,{width:0,height:0,top:core.win.height()/2,left:core.win.width()/2,margin:0,opacity:1,borderWidth:0},{opacity:1,width:1.5*t,height:1.5*t,top:core.win.height()/2-1.5*t/2,left:core.win.width()/2-1.5*t/2,borderWidth:1.5*t/2,onComplete:function(){site.f.initPreload(),core.content.empty(),$.get(o.canonicalPath,{ajax:1},site.f.getAjaxContent)}})}},30)}})},getAjaxContent:function(e){try{core.content.html(e),document.title=page_title;var t=$("#page-classes").attr("data-classes").replace(/ /g," ");core.body.attr("class",t),$.isFunction(site.f.onload)&&site.f.onload(),window.runstack=[],site.f.parseReq()}catch(e){console.log(e)}},updateMenu:function(e){var t=e.replace(host,"").split("/");$(".root-item-selected").removeClass("root-item-selected").addClass("root-item"),core.header.removeClass("show-main-menu_"),t.pop(),t.shift(),e=(e="/"+t.join("/")+"/").replace("//","/"),core.header.removeClass("menuhidden_ favorites_ menucommercial_ menuapartments_ menucommercial-sale_ menucommercial-rent_ headerpath_ roomsresult_ headerback_"),$(".bt-show-mainmenu").removeClass("show_ close_"),e.match(/\/commercial\/sale\/$/)?core.header.addClass("menuhidden_ menucommercial_ menucommercial-sale_"):e.match(/\/commercial\/rent\/$/)?core.header.addClass("menuhidden_ menucommercial_ menucommercial-rent_"):e.match(/\/commercial\/\w+\/(objects|list)\/.*/)?core.header.addClass("menuhidden_ roomsresult_ headerback_"):e.match(/\/commercial\/\w+/)?core.header.addClass("menuhidden_ headerpath_"):e.match(/\/apartments\/[a-z0-9\-]+\//)&&core.header.addClass("menuhidden_ headerpath_");var a=$("a.root-item,a.root-item-selected"),o=($("li.root-item"),$(".submenu a"));a.filter('[href="'+e+'"]').addClass("root-item-selected").removeClass("root-item").closest("root-item").addClass("root-item-selected"),$(".item-selected").removeClass("item-selected"),o.filter('[href="'+e+'"]').each(function(){$(this).closest(".submenu-item").addClass("item-selected").closest(".root-parent").addClass("root-item-selected").children("a").removeClass("root-item").addClass("root-item-selected")})}},$.fn.expandedList=function(o){var n={init:function(){this.find(".js-exp-item").each(function(e,t){var a=$(t),o=a.find(".js-exp-header:first"),i=(a.find(".js-exp-body:first"),a.find(".js-exp-close"));o.click(function(e){e.preventDefault();$(this);var t=a;t.hasClass("open")?n.close.apply(t):n.open.apply(t)}),i.click(function(e){e.preventDefault();var t=a;t.hasClass("open")&&n.close.apply(t)})})},open:function(){this.find(".js-exp-header:first");var e=this.find(".js-exp-body:first");this.addClass("open"),e.stop().slideDown()},close:function(){var e=this;this.find(".js-exp-header:first");this.find(".js-exp-body:first").stop().slideUp(function(){e.removeClass("open")})}};return this.each(function(e,t){var a=$(t);switch(o){case"collapse":a.children(".js-exp-item.open").each(function(){n.close.apply($(this))});break;default:o||(o={}),n.init.apply(a,[o])}})},$.fn.simpleswitch=function(a){var o,i,n={init:function(t){a||(a={}),i=a,t.data("data",a),t.click(function(e){e.preventDefault(),t.hasClass("off")?n.on(t):n.off(t)})},off:function(e){e.addClass("off").removeClass("on"),$.isFunction(i.on_turn_off)&&i.on_turn_off(e),$.isFunction(i.onchange)&&i.onchange(e)},on:function(e){e.addClass("on").removeClass("off"),$.isFunction(i.on_turn_on)&&i.on_turn_on(e),$.isFunction(i.onchange)&&i.onchange(e)}};return this.each(function(e,t){if(o=$(t),a&&"string"==typeof a)switch(i=o.data("data"),a){case"off":n.off(o);break;case"on":n.on(o)}else n.init(o)})},$.fn.radioswitch=function(o,i){var c={init:function(o){var t=[],i=this;i.data("selected",t),i.data("freezed",!1),i.data("options",{}),i.hasClass("disabled")?i.find("a").click(function(e){e.preventDefault()}):i.find("a").each(function(a,e){c.unselectItem.apply(i,[a,!1]),$(e).hasClass("selected")&&(t[a]=!0,i.data("selected",t)),$(e).click(function(e){if(e.preventDefault(),i.hasClass("disabled")||$(this).hasClass("disabled"))return!1;var t=a;return i.data("selected")[a]&&!o.active_mode?c.unselectItem.apply(i,[t,!1]):c.selectItem.apply(i,[t,!1]),!1})}),i.data("options",o)},selectItem:function(e,t){var a=this;if(0<=e&&!a.data("freezed")){var o=a.data("options");if(o.switch_mode)for(var i=a.find("a").length,n=0;n<i;n++)n!=e&&c.unselectItem.apply(a,[n,!0]);var r=a.data("selected"),s="";-1!=$.inArray(!0,r)&&(s=" secondary_"),r[e]=!0,a.data("selected",r);var l=a.find("a:eq("+e+")");l.addClass("selected"+s),!t&&o.setfunction&&o.setfunction(e,l),!t&&o.runfunction&&o.runfunction(e,l)}},unselectItem:function(e,t){var a=this;if(0<=e&&!a.data("freezed")){var o=a.data("selected"),i=a.data("options");if(o&&o[e]){o[e]=!1,a.data("selected",o);var n=a.find("a:eq("+e+")");n.removeClass("selected secondary_"),i.unsetfunction&&i.unsetfunction(e,n,t),i.runfunction&&i.runfunction(e,n)}}},reset:function(){var t=this;t.find("a").each(function(e){c.unselectItem.apply(t,[e])})},soft_reset:function(){var t=this,e=t.data("options");t.data("options",{}),t.find("a").each(function(e){c.unselectItem.apply(t,[e])}),t.data("options",e)}};return this.each(function(e,t){var a=$(t);switch(o){case"freeze":a.data("freezed",!0);break;case"unfreeze":a.data("freezed",!1);break;case"set":c.selectItem.apply(a,[parseInt(i),!1]);break;case"display":c.selectItem.apply(a,[parseInt(i),!0]);break;case"reset":c.reset.apply(a);break;case"soft_reset":c.soft_reset.apply(a);break;default:o||(o={}),c.init.apply(a,[o])}})};var removeArrayItem=function(e,t,a){if(!$.isArray(e)||!e.length)return e;var o=e.slice((a||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,o)};function pad(e,t){var a="000000000"+e;return a.substr(a.length-t)}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}function changeEnding(e,t){var a=String(t),o=parseInt(a[a.length-1]),i={flat:[mess.flat,mess.flat_e1,mess.flat_e2],window:["окно","окна","окон"],bedroom:["спальня","спальни","спален"],penthouse:["пентхаус","пентхауса","пентхаусов"],offer:["предложение","предложения","предложений"]};return i[e]?t<20&&9<t?i[e][2]:1==o?i[e][0]:o&&o<5?i[e][1]:i[e][2]:""}function validateEmail(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function validateDomain(e){return/^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9](?:\.[a-zA-Z]{2,})+$/.test(e)}function validateURL(e){var t=document.createElement("a");return t.href=e,t.host&&t.host!=window.location.host}function validatePhone(e){return/^\+7 \([0-9]{3}\) [0-9]{3}\-[0-9]{2}\-[0-9]{2}$/.test(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}function ValidateForm(e,t){this.form=e,this.action=t,this.inputGroups=this.form.querySelectorAll(".form__group_required"),this.inputGroupsArr=_toConsumableArray(this.inputGroups),this.inputs=this.form.querySelectorAll(".form__input[required]"),this.files=this.form.querySelectorAll('[type="file"]'),this.inputsArr=_toConsumableArray(this.inputs),this.checkboxes=this.form.querySelectorAll(".form__checkbox"),this.submitBtn=this.form.querySelector(".form__submit"),this.telMasks=[],this.telMaskInputs=[],this.response=document.querySelector('[data-modal="'+this.form.dataset.response+'"]'),this.listenToInputs(),this.listenToFiles(),this.listenToCheckboxes(),this.unleashSubmit()}String.prototype.insert=function(e,t){return e>this.length-1?this:0<e?this.substring(0,e)+t+this.substring(e,this.length):t+this},String.prototype.replaceAt=function(e,t){return this.substr(0,e)+t+this.substr(e+t.length)},Number.prototype.formatMoney=function(e,t,a){var o=this,i=(e=isNaN(e=Math.abs(e))?2:e,t=null==t?".":t,a=null==a?",":a,o<0?"-":""),n=parseInt(o=Math.abs(+o||0).toFixed(e))+"",r=3<(r=n.length)?r%3:0;return i+(r?n.substr(0,r)+a:"")+n.substr(r).replace(/(\d{3})(?=\d)/g,"$1"+a)+(e?t+Math.abs(o-n).toFixed(e).slice(2):"")},$.fn.tabs=function(o){var i={init:function(){var t=this,e=t.find("a");t.hasClass("disabled")?e.click(function(e){e.preventDefault()}):e.click(function(e){if(e.preventDefault(),e.stopPropagation(),!$(this).hasClass("active")&&!t.hasClass("disabled"))return i.showtab.apply(t,[this]),!1}),e.filter(".selected").length?e.each(function(){var e=$(this).attr("href").replace("#",""),t=$('*[data-tab-id="'+e+'"]');$(this).hasClass("selected")?t.length&&t.addClass("active").show():t.length&&t.removeClass("active").hide()}):e.each(function(e){var t=$(this).attr("href").replace("#",""),a=$('*[data-tab-id="'+t+'"]');e?a.length&&a.removeClass("active").hide():a.length&&a.addClass("active").show()})},showtab:function(o){var e=this.find("a"),i=this.data("tabs_options");e.each(function(){var e=$(this),t=e.attr("href").replace("#",""),a=$('*[data-tab-id="'+t+'"]');this==o?(e.addClass("selected"),a.length&&(a.addClass("active").show(),$.isFunction(i.onshow)&&i.onshow(a))):(e.removeClass("selected"),a.length&&(a.removeClass("active").hide(),$.isFunction(i.onhide)&&i.onhide(a)))})}};return this.each(function(e,t){var a=$(t);o||(o={}),a.data("tabs_options",o),i.init.apply(a)})},ValidateForm.prototype.phoneMasksArr=["+7 (###) ###-##-##","+7 (9##) ###-##-##","+7 (6##) ###-##-##","+7 (7##) ###-##-##","+1 (###) ###-####","+1 (242) ###-####","+1 (246) ###-####","+1 (264) ###-####","+1 (268) ###-####","+1 (284) ###-####","+1 (340) ###-####","+1 (345) ###-####","+1 (441) ###-####","+1 (473) ###-####","+1 (649) ###-####","+1 (664) ###-####","+1 (670) ###-####","+1 (671) ###-####","+1 (684) ###-####","+1 (721) ###-####","+1 (758) ###-####","+1 (767) ###-####","+1 (784) ###-####","+1 (809) ###-####","+1 (829) ###-####","+1 (849) ###-####","+1 (868) ###-####","+1 (869) ###-####","+1 (876) ###-####","+20 (###) ###-####","+211-##-###-####","+212-##-####-###","+213-##-###-####","+216-##-###-###","+218-##-###-###","+218-21-###-####","+220 (###) ##-##","+221-##-###-####","+222-##-##-####","+223-##-##-####","+224-##-###-###","+225-##-###-###","+226-##-##-####","+227-##-##-####","+228-##-###-###","+229-##-##-####","+230-###-####","+231-##-###-###","+232-##-######","+233 (###) ###-###","+234-##-###-##","+234-##-###-###","+234 (###) ###-####","+235-##-##-##-##","+236-##-##-####","+237-####-####","+238 (###) ##-##","+239-##-#####","+240-##-###-####","+241-#-##-##-##","+242-##-###-####","+243 (###) ###-###","+244 (###) ###-###","+245-#-######","+246-###-####","+247-####","+248-#-###-###","+249-##-###-####","+250 (###) ###-###","+251-##-###-####","+252-#-###-###","+252-##-###-###","+253-##-##-##-##","+254-###-######","+255-##-###-####","+256 (###) ###-###","+257-##-##-####","+258-##-###-###","+260-##-###-####","+261-##-##-#####","+262-#####-####","+263-#-######","+264-##-###-####","+265-#-####-####","+265-1-###-###","+266-#-###-####","+267-##-###-###","+268-##-##-####","+269-##-#####","+27-##-###-####","+290-####","+291-#-###-###","+297-###-####","+298-###-###","+299-##-##-##","+30 (###) ###-####","+31-##-###-####","+32 (###) ###-###","+33 (###) ###-###","+34 (###) ###-###","+350-###-#####","+351-##-###-####","+352 (###) ###-###","+353 (###) ###-###","+354-###-####","+355 (###) ###-###","+356-####-####","+357-##-###-###","+358 (###) ###-##-##","+359 (###) ###-###","+36 (###) ###-###","+370 (###) ##-###","+371-##-###-###","+372-###-####","+372-####-####","+373-####-####","+374-##-###-###","+375 (##) ###-##-##","+376-###-###","+377-##-###-###","+377 (###) ###-###","+378-####-######","+380 (##) ###-##-##","+381-##-###-####","+382-##-###-###","+385-##-###-###","+386-##-###-###","+387-##-####","+387-##-#####","+389-##-###-###","+39 (###) ####-###","+39-6-698-#####","+40-##-###-####","+41-##-###-####","+420 (###) ###-###","+421 (###) ###-###","+423 (###) ###-####","+43 (###) ###-####","+44-##-####-####","+45-##-##-##-##","+46-##-###-####","+47 (###) ##-###","+48 (###) ###-###","+49-###-###","+49 (###) ##-##","+49 (###) ##-###","+49 (###) ##-####","+49 (###) ###-####","+49 (####) ###-####","+500-#####","+501-###-####","+502-#-###-####","+503-##-##-####","+504-####-####","+505-####-####","+506-####-####","+507-###-####","+508-##-####","+509-##-##-####","+51 (###) ###-###","+52-##-##-####","+52 (###) ###-####","+53-#-###-####","+54 (###) ###-####","+55 (##) ####-####","+55 (##) 7###-####","+55 (##) 9####-####","+56-#-####-####","+57 (###) ###-####","+58 (###) ###-####","+590 (###) ###-###","+591-#-###-####","+592-###-####","+593-#-###-####","+593-##-###-####","+594-#####-####","+595 (###) ###-###","+596 (###) ##-##-##","+597-###-###","+597-###-####","+598-#-###-##-##","+599-###-####","+599-9###-####","+60-#-###-###","+60-##-###-###","+60-##-###-####","+60 (###) ###-###","+61-#-####-####","+62 (8##) ###-###","+62 (8##) ###-####","+62 (8##) ###-##-###","+62-##-###-##","+62-##-###-###","+62-##-###-####","+63 (###) ###-####","+64-##-###-###","+64 (###) ###-###","+64 (###) ###-####","+65-####-####","+66-##-###-###","+66-##-###-####","+670-###-####","+670-77#-#####","+670-78#-#####","+672-1##-###","+672-3##-###","+673-###-####","+674-###-####","+675 (###) ##-###","+676-#####","+677-#####","+677-###-####","+678-#####","+678-##-#####","+679-##-#####","+680-###-####","+681-##-####","+682-##-###","+683-####","+685-##-####","+686-##-###","+687-##-####","+688-2####","+688-90####","+689-##-##-##","+690-####","+691-###-####","+692-###-####","+8 (###) ###-##-##"],ValidateForm.prototype.emailRegExp=/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/,ValidateForm.prototype.checkEvery=function(e,t,a){var o=e.getAttribute("type");return!!e.parentNode.parentNode.classList.contains("form__group_required")||("email"===o?null!==e.value.match(this.emailRegExp):"tel"===o?this.telMaskInputs[t].isValid():"text"===o?""!==e.value:void 0)},ValidateForm.prototype.checkGroup=function(e){return e},ValidateForm.prototype.checkGroups=function(){var o=[],i=this;function n(e,t,a){var o=e.getAttribute("type");return"email"===o?null!==e.value.match(i.emailRegExp):"tel"===o?i.telMaskInputs[i.inputsArr.indexOf(e)].isValid():"text"===o?""!==e.value:void 0}return this.inputGroups.forEach(function(e,t){var a=_toConsumableArray(e.querySelectorAll(".form__input"));o.push(a.some(n)),o.every(i.checkGroup)?e.classList.add("form__group_approved"):e.classList.remove("form__group_approved")}),o.every(this.checkGroup)},ValidateForm.prototype.checkInput=function(e,t,a,o){var i=!1;t.parentNode.classList.contains("form__group_required");void 0===a&&(a=!0),a?(t.classList.remove("form__field_pending"),t.classList.add("form__field_approved")):(t.classList.remove("form__field_approved"),t.classList.add("form__field_pending"),void 0!==o&&"blur"===o&&t.classList.add("form__field_warning")),this.inputsArr.every(this.checkEvery,this)&&this.checkGroups()&&null===this.form.querySelector(".form__label_warning")&&(i=!0),i?this.submitBtn.classList.remove("form__submit_disabled"):this.submitBtn.classList.add("form__submit_disabled")},ValidateForm.prototype.checkPhoneUniversal=function(e,t){e.value=e.value.replace(/[^0-9\- \+]/g,""),e.value=e.value.replace(/(?!^)\+/g,"");var a=e.value.match(/(^\+)?[0-9]([\- ]*[0-9]){10}/);null!==a?(e.value=a[0],t.classList.remove("form__field_pending"),t.classList.add("form__field_approved")):(t.classList.remove("form__field_approved"),t.classList.add("form__field_pending"))},ValidateForm.prototype.listenToInputs=function(){var i=this;this.inputs.forEach(function(t,a){var o=t.parentNode,e=t.getAttribute("type");t.hasAttribute("required")?(t.addEventListener("focus",function(){o.classList.remove("form__field_warning")}),"tel"===e?(i.telMasks[a]=new Inputmask({mask:i.phoneMasksArr,definitions:{"#":{validator:"[0-9]",casing:"lower"}},match:/[0-9 +\(\)\-]/,replace:"#"}),i.telMaskInputs[a]=i.telMasks[a].mask(t),t.addEventListener("keyup",function(e){i.checkInput(t,o,i.telMaskInputs[a].isValid())}),t.addEventListener("blur",function(e){i.checkInput(t,o,i.telMaskInputs[a].isValid(),e.type)})):"email"===e?(t.addEventListener("keyup",function(e){i.checkInput(t,o,null!==t.value.match(i.emailRegExp))}),t.addEventListener("blur",function(e){i.checkInput(t,o,null!==t.value.match(i.emailRegExp))})):(t.addEventListener("keyup",function(e){i.checkInput(t,o,""!==t.value)}),t.addEventListener("blur",function(e){i.checkInput(t,o,""!==t.value,e.type)}))):"text"===e&&(t.addEventListener("keyup",function(e){i.checkInput(t,o,""!==t.value)}),t.addEventListener("blur",function(e){i.checkInput(t,o,""!==t.value,e.type)}))})},ValidateForm.prototype.listenToFiles=function(){this.files.forEach(function(i,e){i.addEventListener("change",function(e){var t=i.value,a=$(i).closest(".file-upload-simple");if(t){var o=t.split(/(\\|\/)/g).pop();a.addClass("selected_").find(".file-upload-simple-label").find("span").text(o)}else a.removeClass("selected_").find(".file-upload-simple-label").find("span").text(a.find(".file-upload-simple-label").attr("data-text-default"))})}),this.form.querySelectorAll(".file-upload-simple i").forEach(function(o,e){o.addEventListener("click",function(e){var t=$(o).closest(".file-upload-simple"),a=t.find('input[type="file"]');t.hasClass("selected_")&&(a[0].value="",t.removeClass("selected_").find(".file-upload-simple-label").find("span").text(t.find(".file-upload-simple-label").attr("data-text-default")))})})},ValidateForm.prototype.listenToCheckboxes=function(){var r=this;this.checkboxes.length&&this.checkboxes.forEach(function(e,t){var a=e.nextElementSibling.querySelector("svg"),o=e.parentNode;if(null!==a){var i=a.querySelectorAll("path"),n=new TimelineLite({paused:!0});n.to(i[1],.15,{drawSVG:"0"}).to(i[0],.05,{drawSVG:"0"}),e.addEventListener("change",function(){e.checked?(n.reverse(),e.hasAttribute("required")&&o.classList.remove("form__label_warning")):(n.play(),e.hasAttribute("required")&&o.classList.add("form__label_warning")),r.inputsArr.every(r.checkEvery,r)&&r.checkGroups()&&null===r.form.querySelector(".form__label_warning")?r.submitBtn.classList.remove("form__submit_disabled"):r.submitBtn.classList.add("form__submit_disabled")})}else e.addEventListener("change",function(){e.hasAttribute("required")&&(e.checked?o.classList.remove("form__label_warning"):o.classList.add("form__label_warning")),r.inputsArr.every(r.checkEvery,r)&&r.checkGroups()&&null===r.form.querySelector(".form__label_warning")?r.submitBtn.classList.remove("form__submit_disabled"):r.submitBtn.classList.add("form__submit_disabled")})})},ValidateForm.prototype.validateAll=function(){var i=this;this.inputs.forEach(function(e,t){var a=e.parentNode,o=e.getAttribute("type");"tel"===o?i.checkInput(e,a,i.telMaskInputs[t].isValid(),"blur"):"email"===o?i.checkInput(e,a,null!==e.value.match(i.emailRegExp),"blur"):"text"===o&&i.checkInput(e,a,""!==e.value,"blur")}),this.checkboxes.forEach(function(e,t){e.hasAttribute("required")&&(e.checked||e.parentNode.classList.add("form__label_warning"))});var e=this.inputsArr.filter(function(e){return!e.parentNode.parentNode.classList.contains("form__group_required")}),t=!1,a=!1;if(e.length&&e.some(function(e){return e.parentNode.classList.contains("form__field_warning")})||(t=!0),this.inputGroupsArr.every(function(e){return e.classList.contains("form__group_approved")})&&(a=!0),t&&a&&null===this.form.querySelector(".form__label_warning")){var o=this.response,n=($(this.form).closest(".modal").addClass("sending_"),new FormData(this.form));$.ajax({url:this.action,data:n,type:"POST",contentType:!1,processData:!1,success:function(e){"OK"==e?(console.log("data ok"),i.form.reset(),i.form.querySelectorAll(".form__field").forEach(function(e){e.classList.remove("form__field_approved","form__field_warning","form__field_pending")}),i.files.forEach(function(e,t){var a=$(e).closest(".file-upload-simple");a.removeClass("selected_").find(".file-upload-simple-label").find("span").text(a.find(".file-upload-simple-label").attr("data-text-default"))}),null!==document.querySelector(".modal_active")&&document.querySelector(".modal_active").classList.remove("modal_active"),null!==document.querySelector(".modal.sending_")&&document.querySelector(".modal.sending_").classList.remove("sending_"),o.classList.add("modal_active")):(console.log("data error"),alert("При отправке сообщения произошла ошибка."))}}).fail(function(){alert("При отправке сообщения произошла ошибка."),null!==document.querySelector(".modal.sending_")&&document.querySelector(".modal.sending_").classList.remove("sending_")})}else this.form.querySelector(".form__field_warning").querySelector(".form__input").focus()},ValidateForm.prototype.unleashSubmit=function(){var t=this;null!==this.submitBtn&&this.submitBtn.addEventListener("click",function(e){e.preventDefault(),t.validateAll()})};var _area_detail={plans_slider:[],init:function(){_area_detail.$wnd=$(".wnd-area-detail"),_area_detail.$wnd_loader=_area_detail.$wnd.find(".loader-circular"),_area_detail.$container=$(".wnd-area-detail-container"),_area_detail.$container.click(function(e){e.preventDefault(),e.stopPropagation()}),_area_detail.$wnd.click(_area_detail.closeWnd),_area_detail.$wnd.find(".wad-close").click(_area_detail.closeWnd),$(".areas-table-row").click(function(e){e.preventDefault();var t=parseInt($(this).attr("id").replace("area-",""));t&&$.get("/ajax/detail/",{id:t},_area_detail.showWnd)})},onClick:function(e){e&&TweenMax.fromTo(_area_detail.$wnd_loader,.5,{opacity:0},{opacity:1}),TweenMax.fromTo(_area_detail.$wnd,.5,{backgroundColor:"rgba(170,170,170,0)"},{backgroundColor:"rgba(170,170,170,.9)",display:"block",onComplete:function(){$.get("/ajax/detail/",{id:e},_area_detail.showWnd)}})},clickNext:function(e){var t=$(e).attr("href").replace("#","");$(".flat-detail-wnd").velocity("fadeOut",{complete:function(){$(this).empty(),_area_detail.onClick(t)}})},closeWnd:function(){if(_area_detail.$wnd.hasClass("open_")){TweenMax.fromTo(_area_detail.$wnd.find(".wad-close"),.3,{opacity:1},{opacity:0}),_area_detail.$wnd.removeClass("open_"),_area_detail.$container.perfectScrollbar("destroy");var e=new TimelineMax({onComplete:function(){TweenMax.to(_area_detail.$wnd,1,{backgroundColor:"rgba(170,170,170,0)",display:"none",onComplete:function(){_area_detail.$container.empty(),void 0!==_area_detail.gallery_slider&&_area_detail.gallery_slider.destroy(),$.isFunction(_area_detail.plans_slider.each)&&_area_detail.plans_slider.each(function(){this.destroy()})}})}}),t=new TimelineMax;e.staggerTo(_area_detail.$wnd.find(".wad-anim"),.4,{rotationX:-20,y:200,opacity:0},-.02),t.staggerTo(_area_detail.$wnd.find(".wad-anim-inner"),.4,{y:100,opacity:0},-.05),request_data=[]}},showWnd:function(e){if(_area_detail.$container.html(e),!_area_detail.$wnd.hasClass("open_")){_area_detail.$wnd.addClass("open_"),TweenMax.fromTo(_area_detail.$wnd_loader,.5,{opacity:1},{opacity:0}),_area_detail.$container[0].scrollTop=0;var t=new TimelineMax({onComplete:function(){_area_detail.$container.perfectScrollbar();var e=_area_detail.$wnd.find("#pdfb");void 0===$._data(e[0],"events")&&e.hide(),_area_detail.$wnd.find(".wad-scheme").each(function(){_area_detail.plans_slider.push(new Swiper(this,{speed:1e3,shortSwipes:!1,autoHeight:!0,pagination:{el:$(this).find(".wad-scheme-pagination")[0],clickable:!0,renderBullet:function(e,t){return'<span class="'+t+'">'+area_detail_slider[e]+"</span>"}}}))});var t=_area_detail.$wnd.find(".wad-gallery");t.length&&(_area_detail.gallery_slider=new Swiper(t[0],{speed:1e3,loop:!0,navigation:{nextEl:t.find(".wad-gallery-next")[0],prevEl:t.find(".wad-gallery-prev")[0]},pagination:{el:t.find(".wad-gallery-pagination")[0],clickable:!0}}))}}),a=new TimelineMax;t.staggerFromTo(_area_detail.$wnd.find(".wad-anim"),.4,{rotationX:-20,y:100,opacity:0},{rotationX:0,y:0,opacity:1},.1),a.staggerFromTo(_area_detail.$wnd.find(".wad-anim-inner"),.4,{y:100,opacity:0},{y:0,opacity:1},.05),TweenMax.fromTo(_area_detail.$wnd.find(".wad-close"),.3,{opacity:0},{opacity:1}),_area_detail.initCallback(),$(".js-jump-to-ff").click(function(e){e.preventDefault(),$('a[name="'+$(this).attr("href").replace("#","")+'"]').length&&TweenMax.to(_area_detail.$wnd.find(".wnd-area-detail-container"),.6,{scrollTo:'a[name="'+$(this).attr("href").replace("#","")+'"]'})}),$(".tabmenu").tabs({onshow:function(e){e[0].swiper.update()}})}},applSend:function(e){var t=$(e).closest(".wnd-area-detail-container");request_data.push({id:"message",val:t.find(".flat-detail-order").text()}),$(".js-callback").trigger("click")},initCallback:function(){var e=document.querySelector(".form_layout");null!==document.querySelector(".form_layout")&&new ValidateForm(e,"/ajax/forms/callorder.php")}},_career={init:function(){$(".vacancy-category").click(function(e){e.preventDefault();var t=$(this),a=t.toggleClass("active").next(),o=0;t.hasClass("active")?(a.find(".vacancy-list-item").each(function(){var e=$(this);o+=e.outerHeight(!0)+10}),TweenMax.to(a,.4,{height:o,visibility:"visible",marginBottom:20})):TweenMax.to(a,.4,{height:0,display:"hidden",marginBottom:0})}),new Swiper(".career-gallery",{speed:600,slidesPerView:3,loop:!0,navigation:{nextEl:".career-gallery .slide-hz-next",prevEl:".career-gallery .slide-hz-prev"},autoplay:{delay:3e3,disableOnInteraction:!1}})}},_commercial={init:function(){var t=$(".choice-four-buttons.rent_"),a=$(".choice-four-buttons.sale_");$(".header-menu-switch > a").click(function(e){e.preventDefault(),$(this).index()?t.hasClass("active")||(t.addClass("active"),a.removeClass("active"),TweenMax.fromTo(t,1,{rotationX:-180,z:-96},{rotationX:0,z:0,ease:Expo.easeInOut}),TweenMax.fromTo(a,1,{rotationX:0,z:0},{rotationX:180,z:-96,ease:Expo.easeInOut}),core.header.removeClass("menucommercial-sale_").addClass("menucommercial-rent_")):a.hasClass("active")||(a.addClass("active"),t.removeClass("active"),TweenMax.fromTo(a,1,{rotationX:-180,z:-96},{rotationX:0,z:0,ease:Expo.easeInOut}),TweenMax.fromTo(t,1,{rotationX:0,z:0},{rotationX:180,z:-96,ease:Expo.easeInOut}),core.header.removeClass("menucommercial-rent_").addClass("menucommercial-sale_"))})},unload:function(){void 0!==_area_detail.$wnd&&_area_detail.closeWnd()}},_commercial_index={init:function(){var e=$(".choose-two-button");new TimelineLite({delay:.4}).staggerFromTo(e,.6,{opacity:0,y:40,z:30,rotationX:60},{opacity:1,y:0,z:0,rotationX:0},.1);var t=$("#video");if(t.length){var a=t[0];_commercial_index.vint=setInterval(function(){3<=a.readyState&&(clearInterval(_commercial_index.vint),a.play(),site.loading=!1)},100),setTimeout(function(){site.loading&&(site.loading=!1,clearInterval(_commercial_index.vint),t.attr("autoplay","autoplay"),t[0].play())},1e4)}var i=$(".choose-two-buttons"),n=$(".choice-four-buttons"),r=$(".choice-header-slogan.visibilityhidden"),s=$(".choice-header-slogan:not(.visibilityhidden)");$(".choose-two-buttons .overlay-link").click(function(e){e.preventDefault();var t=$(this),a=(t.attr("href"),t.closest(".choose-two-button").index()),o=n.get(a);n.get(a?0:1);$(o).addClass("active"),(new TimelineLite).set(".choice-four-buttons-container",{display:"block"}).to(i,.6,{rotationX:90,ease:Expo.easeIn}).to(i,.3,{rotationX:180,z:-100,y:50}).to(s,.3,{opacity:0,y:-50},.6).fromTo(r,.3,{opacity:0,y:50,visibility:"visible"},{opacity:1,y:0},.6).fromTo(o,.3,{rotationX:-180,z:-96},{rotationX:0,z:0},.6).set(i,{visibility:"hidden"},.6).to(".choice-four-buttons-container",1,{top:"100%",marginTop:-94,ease:Expo.easeInOut},.6).to(".video-bg",1,{height:"70%",ease:Expo.easeInOut},.6).to(i,1,{top:"100%",ease:Expo.easeInOut},.6).to(".commercial-index-slogan",1,{height:"100%",ease:Expo.easeInOut},.6).set(".commercial-index-info",{paddingTop:120},0).to(".commercial-index-info",1,{visibility:"visible",height:"auto",opacity:1},1).call(function(){core.header.addClass("menuhidden_ menucommercial_ menucommercial-"+(a?"rent":"sale")+"_")},null,null,.6)})},unload:function(){void 0!==_commercial_index.vint&&clearInterval(_commercial_index.vint)}},_commercial_rent={init:function(){_commercial_sale.init()}},_commercial_sale={init:function(){_commercial_sale.buttons=$(".choice-four-button"),_commercial_sale.bgs=$(".choice-header-bg"),_commercial_sale.buttons.hover(function(){var e=$(this).index();TweenMax.to(_commercial_sale.bgs.eq(e),.6,{scale:1,opacity:1})},function(){var e=$(this).index();TweenMax.to(_commercial_sale.bgs.eq(e),.6,{scale:1.1,opacity:0})})}},_contacts={init:function(){var o=$(".contacts-slider"),a=$(".office-gallery"),i=new Swiper(o[0],{speed:1e3,effect:"fade",autoHeight:!0,allowTouchMove:!1,pagination:{el:".contacts-slider-pager",renderBullet:function(e,t){return'<span class="'+t+'">'+(contacts_bullets[e].logo?'<div style="background-image:url(/svg/x000000'+contacts_bullets[e].logo+')"></div>':contacts_bullets[e].name)+"</span>"},clickable:!0}});i.on("transitionStart",function(){o.find('.swiper-slide:not([data-swiper-slide-index="'+i.realIndex+'"])').find(".office-gallery .swiper-slide div").addClass("notransition notransform")}).on("transitionEnd",function(){o.find('.swiper-slide:not([data-swiper-slide-index="'+i.realIndex+'"])').find(".office-gallery .swiper-slide div").removeClass("notransition notransform")}),setTimeout(function(){i.update(),a.each(function(){var e=$(this);new Swiper(this,{speed:1e3,effect:"slide",nested:!0,parallax:!0,loop:!0,shortSwipes:!1,navigation:{nextEl:e.find(".slide-hz-next"),prevEl:e.find(".slide-hz-prev")},pagination:{el:e.find(".pagination-fraction"),type:"fraction",renderFraction:function(e,t){return'<span class="'+e+'"></span><span></span><span class="'+t+'"></span>'}},on:{slideNextTransitionStart:function(){e.find(".pagination-fraction").addClass("anim-fow_")},slidePrevTransitionStart:function(){e.find(".pagination-fraction").addClass("anim-back_")},slideChangeTransitionEnd:function(){e.find(".pagination-fraction").removeClass("anim-fow_ anim-back_")}}})});var e=window.location.hash;if(e){var t=o.find('[data-code="'+e.replace("#","")+'"]');t.length&&i.slideTo(t.index(),0)}},500),$(".office-info-intro-show-gallery").click(function(e){e.preventDefault();var t=$(this).closest(".office-info"),a=t.find(".office-gallery");TweenMax.fromTo(a,1,{x:"100%",scale:1.5,visibility:"visible"},{x:"0%",scale:1}),TweenMax.to(t.find(".office-info-intro"),1,{x:"-100%"}),TweenMax.to(t.find(".office-info-intro-img"),1,{scale:1.5})}),$(".office-info-address").click(function(e){e.preventDefault();var t=$(this).closest(".office-info"),a=t.find(".office-map-wnd");a.hasClass("open_")?(a.removeClass("open_"),TweenMax.to(t.find(".office-map-wnd"),.6,{autoAlpha:0})):(a.addClass("open_"),TweenMax.to(t.find(".office-map-wnd"),.6,{autoAlpha:1}))}),$(".bt-play-video").click(function(e){e.preventDefault();var t=$(this).attr("data-video-trg"),a=$('.wnd-video[data-video="'+t+'"]'),o=a.find("iframe");o.attr("src",o.attr("data-src")),TweenMax.to(a,.4,{opacity:1,display:"block"})}),$(".wnd-video").find(".js-window-close").click(function(e){e.preventDefault();var t=$(this).closest(".wnd-video");TweenMax.to(t,.4,{opacity:0,display:"none",onComplete:function(){t.find("iframe").attr("src","")}})}),"undefined"==typeof ymaps&&core.content.append('<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"><\/script>');var e=setInterval(function(){"undefined"!=typeof ymaps&&(clearInterval(e),site.loading=!1,ymaps.ready(_contacts.loadMap))},200);$(".choice-footer-office").click(function(e){e.preventDefault();var t=$(this).attr("href").split("#");t=1<t.length?t.pop():"central";var a=o.find('[data-code="'+t+'"]');a.length&&(i.slideTo(a.index()),TweenMax.to(window,.6,{scrollTo:{y:0}}))})},loadMap:function(){$(".office-map-container").each(function(){var e=$(this).closest(".office-info"),t=e.attr("data-id");if(t){var a=offices_coordinates[t],o=new ymaps.Map(this,{center:a,zoom:16});o.behaviors.disable(["scrollZoom"]);void 0!==offices_pointers[t]&&offices_pointers[t]&&offices_pointers[t],void 0!==offices_pointer_dim[t]&&offices_pointer_dim[t][0]&&offices_pointer_dim[t];var i=new ymaps.Placemark(a,{balloonContentHeader:"",balloonContentBody:'<div class="contacts-balloon-address">'+contacts_address[t]+"<br/>"+contacts_time[t]+'</div><div class="contacts-balloon-link"><a target="_blank" href="https://yandex.ru/maps/213/moscow/?ll='+a[1]+"%2C"+a[0]+"&z=17&mode=routes&rtext=~"+a.join("%2C")+'&rtt=auto">Проложить маршрут</a></div>',balloonContentFooter:""},{balloonCloseButton:!1});o.geoObjects.add(i),i.balloon.open(),e.find(".office-map-wnd .window-close-black").click(function(){TweenMax.to(e.find(".office-map-wnd"),.6,{autoAlpha:0})})}})},unload:function(){void 0!==_contacts.vimeo_int&&clearInterval(_contacts.vimeo_int)}},_cooperation_main={init:function(){var e=$(".choose-two-button");new TimelineLite({delay:.4}).staggerFromTo(e,.6,{opacity:0,y:40,z:30,rotationX:60},{opacity:1,y:0,z:0,rotationX:0},.1);var t=$("#video");t.length&&t[0].play(),setTimeout(function(){site.loading&&(site.loading=!1)},10);var a=$(".common-intro-slogan > span span");new SplitText(a,{type:"chars"}),a.css("opacity",1),TweenMax.set(a.eq(0).find("div"),{opacity:1});var o=Power2.easeInOut;new TimelineMax({repeat:-1,repeatDelay:2}).staggerFromTo(a.eq(0).find("div"),.8,{x:0,opacity:1},{x:"-50px",opacity:0,ease:o},.05).staggerFromTo(a.eq(1).find("div"),.8,{x:"50px",opacity:0},{x:0,opacity:1,ease:o},.05,"-=1").staggerTo(a.eq(1).find("div"),.8,{x:"-50px",opacity:0,ease:o},.05,"+=3").staggerFromTo(a.eq(2).find("div"),.8,{x:"50px",opacity:0},{x:0,opacity:1,ease:o},.05,"-=1").staggerTo(a.eq(2).find("div"),.8,{x:"-50px",opacity:0,ease:o},.05,"+=3").staggerFromTo(a.eq(0).find("div"),.8,{x:"50px",opacity:0},{x:0,opacity:1,ease:o},.05,"-=1")},unload:function(){void 0!==_cooperation_main.vint&&clearInterval(_cooperation_main.vint)}},_expanded_blocks={init:function(){$(".expanded-list-h").click(function(e){e.preventDefault();var t=$(this),a=t.toggleClass("active").next().toggleClass("active"),o=0,i=a.find(".expanded-list-content-inner");t.hasClass("active")?(o=i.height(),TweenMax.to(a,.4,{height:a.find(".tender-contacts").length?o+50:o,visibility:"visible",marginBottom:20})):TweenMax.to(a,.4,{height:0,visibility:"hidden",marginBottom:0})})}},_experience_detail={page_loaded:!1,init:function(){_experience_detail.page_loaded=!1;var e=new createjs.LoadQueue;"undefined"!=typeof exp_img_src&&exp_img_src?(e.loadManifest([exp_img_src]),e.on("complete",_experience_detail.loadPage),setTimeout(_experience_detail.loadPage,1e4)):setTimeout(_experience_detail.loadPage,100);var t=document.getElementById("video");t&&t.play()},loadPage:function(){if(site.loading=!1,!_experience_detail.page_loaded){_experience_detail.page_loaded=!0;var t=$(".gallery-prj-to-reality"),e=($(".gallery-prj-to-reality-labels").children(),$(".commercial-video").length),a=$(".experience-detail-intro-slider");if(1<a.find(".swiper-slide").length){var o=new Swiper(".experience-detail-intro-slider",{slidesPerView:1,speed:1e3,loop:!0,parallax:!0,autoplay:{delay:4e3},navigation:{nextEl:".experience-detail-intro-slider .bottom-next-square",prevEl:".experience-detail-intro-slider .bottom-prev-square"},pagination:{el:".experience-detail-intro-slider .pagination-fraction",type:"fraction",renderFraction:function(e,t){return'<span class="'+e+'"></span><span></span><span class="'+t+'"></span>'}},on:{slideNextTransitionStart:function(){a.find(".pagination-fraction").addClass("anim-fow_")},slidePrevTransitionStart:function(){a.find(".pagination-fraction").addClass("anim-back_")},slideChangeTransitionEnd:function(){a.find(".pagination-fraction").removeClass("anim-fow_ anim-back_")}}});e&&o.autoplay.stop()}else a.find(".bottom-prev-square,.bottom-next-square,.pagination-fraction").hide();if(t.length)new Swiper(t[0],{slidesPerView:1,speed:1e3,loop:!0,simulateTouch:!1,allowTouchMove:!1,navigation:{nextEl:".gallery-next-square",prevEl:".gallery-prev-square"},pagination:{el:".gallery-prj-to-reality .pagination-fraction",type:"fraction",renderFraction:function(e,t){return'<span class="'+e+'"></span><span></span><span class="'+t+'"></span>'}},on:{init:function(){$(".gallery-prj-to-reality .swiper-slide").each(function(){var e=$(this),n=e.width(),r=e.height();e.find("img").each(function(){var e=$(this),t=e.width()/e.height(),a=n,o=a/t;o<r&&(a=(o=r)*t);var i={width:parseInt(a),height:parseInt(o),left:parseInt((n-a)/2),top:parseInt((r-o)/2)};e.css(i)})}),setTimeout(function(){$(".image-compare").each(function(){var e=$(this),t=e.attr("data-position");e.twentytwenty({default_offset_pct:t||.15})})},100),setTimeout(function(){t.find(".twentytwenty-handle").on("move.ext",function(e){_experience_detail.sliderPct=(e.pageX-t.offset().left)/t.width(),_experience_detail.sliderPct<.15&&(_experience_detail.sliderPct=.15),.85<_experience_detail.sliderPct&&(_experience_detail.sliderPct=.85)})},150)},slideNextTransitionStart:function(){t.find(".pagination-fraction").addClass("anim-fow_")},slidePrevTransitionStart:function(){t.find(".pagination-fraction").addClass("anim-back_")},slideChangeTransitionEnd:function(){t.find(".pagination-fraction").removeClass("anim-fow_ anim-back_")}}})}}},_experience_list={init:function(){_experience_list.$sec_headers=$(".hm-sec-header"),setTimeout(function(){site.loading=!1,_experience_list.intro()},100)},intro:function(){_experience_list.setScroll();var e=_experience_list.$sec_headers.eq(0).addClass("shown_");new TimelineMax({onComplete:function(){}}).to(".exp-half-screen",1,{bottom:"50%",ease:Expo.easeOut},.5).to(".exp-col-right",1.6,{marginTop:"0vh",ease:Expo.easeOut},.5).to(".exp-col-left",1.6,{marginTop:"0vh",ease:Expo.easeOut},.7).fromTo(e,.8,{opacity:0,y:"150%"},{opacity:1,y:"0%"},.7)},setScroll:function(){$(".hm-content-item").each(function(e){$(this),new ScrollMagic.Scene({triggerElement:this,duration:"150%",triggerHook:.8}).setTween(TweenMax.fromTo(this,1,{y:0},{y:-200})).addTo(site.sm_controller)}).hover(function(){var e=$(this),t=e.find(".circle_"),a=e.find("circle");TweenMax.to(a,.4,{drawSVG:"80% 100%"}),TweenMax.fromTo(t,1,{rotation:0},{rotation:360,repeat:5,ease:Power0.easeNone})},function(){var e=$(this),t=e.find(".circle_"),a=e.find("circle");TweenMax.to(a,.4,{drawSVG:"0% 100%"}),TweenMax.to(t,.4,{rotation:540})});var e=$(".hm-content-text"),t=$(".exp-col-right").height()/(e.length+1);e.each(function(){$(this).index(),new ScrollMagic.Scene({triggerElement:this,duration:t,triggerHook:.56}).setPin(this,{pushfollowers:!1}).addTo(site.sm_controller)})},unload:function(){site.sm_controller.destroy(!1)}},_footer_offices={init:function(){_footer_offices.footer=$(".choice-footer-offices"),_footer_offices.items=_footer_offices.footer.find(".choice-footer-office"),_footer_offices.bgs=_footer_offices.footer.find(".choice-footer-offices-bg > div"),_footer_offices.items.hover(function(e){var t=$(this).index();if(1!=t){var a=e.originalEvent.pageX,o=core.win.width()-a;(new TimelineMax).fromTo(_footer_offices.bgs.eq(t),1.2,{left:a,right:o,opacity:0},{left:0,right:0,opacity:1,ease:Expo.easeOut}).to(_footer_offices.bgs.eq(t).find("div"),1.2,{scale:1,ease:Expo.easeOut},0)}},function(e){var t=$(this).index();if(1!=t){var a=e.originalEvent.pageX;core.win.width();(new TimelineMax).to(_footer_offices.bgs.eq(t),.6,{opacity:0,ease:Expo.easeIn}).to(_footer_offices.bgs.eq(t).find("div"),.6,{scale:1.1,ease:Expo.easeIn},0)}})}},_homepage={start_scroll:!1,color:["#f1eee9","#e9e6df","#dddad3","#e7e4df","#dbd5c9"],st:0,wave_stop:!0,scroll_delta:0,scroll_delta_max:20,cur_scroll_delta:0,init:function(){site.bg_lazy_stop=!0,_homepage.start_scroll=!1,_homepage.$intro=$(".hm-intro"),_homepage.$slogan1=$(".hm-intro-slogan-1"),_homepage.$slogan2=$(".hm-intro-slogan-2"),_homepage.$half_overlay=$(".hm-half-overlay"),_homepage.$video=$("#video"),_homepage.$video.length&&_homepage.$video[0].play(),core.content.css("overflow","hidden"),setTimeout(function(){site.loading=!1,_homepage.intro()},10),window.addEventListener("orientationchange",function(){window.location.reload()})},intro:function(){$("#circ").attr("d");var e=$("#halfway").attr("d"),t=$("#straight").attr("d");_homepage.tl=new TimelineMax({onComplete:function(){core.content.css("overflow","visible"),_homepage.$intro.find(".intro-circle").hide(),setTimeout(_homepage.setScroll,100),setTimeout(function(){core.win.on("scroll.homepage",_homepage.onScroll)},150)}}),_homepage.tl.set("#arrow-scroll-down-l",{drawSVG:"100% 100%"}).set("#arrow-scroll-down-a",{drawSVG:"50% 50%"}).staggerFromTo(_homepage.$slogan1.find("div"),1.2,{y:"-150%",opacity:0},{y:"0%",opacity:1,ease:Expo.easeOut},.06,0).staggerFromTo(_homepage.$slogan1.find("span"),1.2,{y:"200%"},{y:"0%",ease:Expo.easeOut},.06,0).staggerFromTo(_homepage.$slogan2.find("div"),1.2,{y:"60%",opacity:0},{y:"0%",opacity:1},.07,1).staggerFromTo(_homepage.$slogan2.find("span"),1.2,{y:"-100%"},{y:"0%"},.07,1).set("#circ",{drawSVG:"0%"},0).to("#circ",2,{drawSVG:"100%"},.6).to("#circ",.1,{morphSVG:{shape:e,shapeIndex:0},ease:Power0.linear}).to("#circ",1,{morphSVG:{shape:t,shapeIndex:0},ease:Power1.easeOut}).to(_homepage.$half_overlay,.8,{height:"100%",ease:Expo.easeInOut,onStart:function(){_homepage.$video[0].play()}},"-=0.2").to(".hm-intro-slogan",1.2,{y:-50},"-=1.8").to(_homepage.$slogan2.find("span"),.3,{color:"#FFF",ease:Expo.easeOut},"-=.6").to(_homepage.$slogan1.find("span"),.3,{color:"#FFF",ease:Expo.easeOut},"-=.5").to(".hm-slogan-pleasure",1,{y:20,opacity:1,ease:Power1.easeOut},"-=.6").to("#arrow-scroll-down-l",.4,{drawSVG:"0% 100%"},"-=.6").to("#arrow-scroll-down-a",.4,{drawSVG:"0% 100%"},"-=.1").to(".hm-menu",1.8,{y:.4*-core.win.height(),opacity:1}).to(".hm-content-first",1.8,{y:.4*-core.win.height(),opacity:1},"-=1.8").to(".hm-content-item.first_",1.2,{marginTop:.1*-core.win.height()},"-=1.6")},onScroll:function(){var e=core.win.scrollTop();_homepage.$sec_headers=$(".hm-sec-header"),_homepage.$sec_headers_1=_homepage.$sec_headers.eq(0),_homepage.start_scroll?0==e&&_homepage.$intro.hasClass("hide-slogan_")?_homepage.showIntroHead():0<e&&!_homepage.$intro.hasClass("hide-slogan_")&&_homepage.hideIntroHead():(_homepage.start_scroll=!0,_homepage.hideIntroHead(),_homepage.initEvents(),_homepage.showWave(),_homepage.start_scroll=!0),0==e?core.header.removeClass("scrolled_"):core.header.addClass("scrolled_"),10<e&&site.bg_lazy_stop&&(site.bg_lazy_stop=!1,site.f.bgLazyLoad())},showIntroHead:function(){console.log("showIntroHead"),_homepage.$video[0].play(),void 0===_homepage.head_tl?(_homepage.head_tl=new TimelineMax,_homepage.head_tl.fromTo(_homepage.$intro.find(".hm-intro-slogan"),.8,{y:100,opacity:0},{y:-50,opacity:1}).fromTo(_homepage.$intro.find(".hm-slogan-pleasure"),.8,{y:-100,opacity:0},{y:20,opacity:1},0).to(_homepage.$intro.find("#video"),.4,{opacity:1},0).fromTo(_homepage.$intro.find(".arrow-scroll-down"),.4,{y:50,opacity:0},{y:100,opacity:1}).fromTo(_homepage.$intro.find("#arrow-scroll-down-l"),.4,{drawSVG:"0% 100%"},{drawSVG:"0% 100%"},"-=.2").fromTo(_homepage.$intro.find("#arrow-scroll-down-a"),.4,{drawSVG:"0% 100%"},{drawSVG:"0% 100%"},"-=.1")):_homepage.head_tl.restart(),_homepage.$intro.removeClass("hide-slogan_"),_homepage.$sec_headers_1.hasClass("shown_")&&(_homepage.$sec_headers_1.removeClass("shown_"),TweenMax.fromTo(_homepage.$sec_headers_1,.6,{opacity:1,y:"0%"},{opacity:0,y:"-100%"}))},hideIntroHead:function(){console.log("hideIntroHead"),void 0!==_homepage.head_tl&&_homepage.head_tl.pause(),_homepage.$intro.addClass("hide-slogan_"),TweenMax.to(_homepage.$intro.find(".hm-intro-slogan"),.4,{y:-300,opacity:0}),TweenMax.to(_homepage.$intro.find(".hm-slogan-pleasure"),.4,{y:-200,opacity:0}),TweenMax.to(_homepage.$intro.find(".arrow-scroll-down"),.4,{y:0,opacity:0}),TweenMax.to(_homepage.$intro.find("#video"),.4,{opacity:0,onComplete:function(){_homepage.$video[0].pause()}}),_homepage.$sec_headers_1.hasClass("shown_")||(_homepage.$sec_headers_1.addClass("shown_"),TweenMax.fromTo(_homepage.$sec_headers_1,.6,{opacity:0,y:"150%"},{opacity:1,y:"0%"}))},setScroll:function(){$(".hm-content-item").each(function(e){var t=$(this);new ScrollMagic.Scene({triggerElement:this,duration:"300%",triggerHook:.8}).setTween(TweenMax.fromTo(this,1,{y:0},{y:core.html.hasClass("browser-ie")?-200:-350})).on("enter",function(){t.addClass("in-view")}).on("leave",function(){t.removeClass("in-view")}).addTo(site.sm_controller)}),$(".hm-content-text").each(function(){var e=$(this),a=parseInt(e.attr("data-sec")),t=(parseInt(e.attr("data-cnt")),$('.hm-content-section[data-sec-child="'+a+'"]')),o=t.height()+parseInt(t.css("paddingBottom"))+parseInt(t.css("paddingTop"));new ScrollMagic.Scene({triggerElement:this,duration:o-260,triggerHook:.56}).setPin(this,{pushfollowers:!1}).on("leave",function(){console.log("leave sec "+a);var e=_homepage.$sec_headers.filter("[data-sec="+a+"]");e.removeClass("shown_"),TweenMax.fromTo(e,.6,{opacity:1,y:"0%"},{opacity:0,y:"-200%"})}).on("enter",function(){console.log("enter sec "+a);var e=_homepage.$sec_headers.filter("[data-sec="+a+"]"),t=e.index();e.hasClass("shown_")||(e.addClass("shown_"),TweenMax.fromTo(e,.4,{opacity:0,y:"150%"},{opacity:1,y:"0%"}),TweenMax.to(_homepage.$half_overlay,.6,{backgroundColor:_homepage.color[t]}))}).addTo(site.sm_controller)}),core.win.on("scroll.wave",function(){_homepage.st=core.win.scrollTop(),_homepage.scroll_delta=_homepage.scroll_delta_max})},initEvents:function(){_homepage.$sec_show_overlay=$(".hm-sec-show-wnd"),_homepage.$sec_show_img=_homepage.$sec_show_overlay.find(".sec-show-img"),_homepage.$sec_show_bg=_homepage.$sec_show_overlay.find(".sec-show-bg"),_homepage.$slider=$(".hm-slider"),_homepage.$sliders=_homepage.$slider.find(".swiper-slide"),_homepage.slider={},_homepage.$slider.each(function(){$(this).attr("data-slider-sec")}),_homepage.slider=new Swiper(_homepage.$slider,{speed:1e3,effect:"fade",shortSwipes:!1,navigation:{nextEl:_homepage.$slider.find(".hm-slider-nav-right"),prevEl:_homepage.$slider.find(".hm-slider-nav-left")}}),$(".hm-content-item").click(function(e){e.preventDefault();var t=$(this),a=t.find(".hm-content-item-img-inner"),o=a[0].getBoundingClientRect(),i=(t.attr("data-item-sec"),parseInt(t.attr("data-glob-idx"))),n=_homepage.$slider,r=n.find(".swiper-slide");_homepage.slider.slideTo(i,0),(new TimelineMax).set(_homepage.$sec_show_bg,{right:"40%"}).set(_homepage.$sec_show_overlay,{visibility:"visible",opacity:1}).set(_homepage.$sec_show_img,{backgroundImage:a.css("backgroundImage"),top:o.top,left:"60%",width:512,height:320}).to(_homepage.$sec_show_img,.8,{top:0,height:"100%",ease:Expo.easeOut},0).to(_homepage.$sec_show_img,.7,{left:0,width:"100%",x:0,ease:Expo.easeOut},0).set(n,{visibility:"visible",opacity:1}).set(r.filter(".swiper-slide-active"),{opacity:1}).to(_homepage.$sec_show_bg,1,{right:20,ease:Expo.easeOut},.4).to(_homepage.$sec_show_overlay,1,{autoAlpha:0},"-=0.4").set(_homepage.$sec_show_img,{backgroundImage:""})}).hover(function(){var e=$(this),t=e.find(".circle_"),a=e.find("circle");TweenMax.to(a,.4,{drawSVG:"80% 100%"}),TweenMax.fromTo(t,1,{rotation:0},{rotation:360,repeat:5,ease:Power0.easeNone})},function(){var e=$(this),t=e.find(".circle_"),a=e.find("circle");TweenMax.to(a,.4,{drawSVG:"0% 100%"}),TweenMax.to(t,.4,{rotation:540})}),$(".hm-slider-close").click(function(e){e.preventDefault();var t=$(this).closest(".swiper-slide"),a=t.find(".hm-slider-img"),o=t.find(".hm-slider-info"),i=$(this).closest(".hm-slider"),n=i.find(".swiper-slide"),r=new TimelineMax({onComplete:function(){TweenMax.set(i,{visibility:"hidden",opacity:0}),TweenMax.set(a,{x:"0%"}),TweenMax.set(o,{x:"0%"})}});TweenMax.set(n.not(t),{opacity:0}),r.to(a,1,{x:"100%",ease:Expo.easeOut}).to(o,1,{x:"120%",ease:Expo.easeOut},0)})},changeSection:function(){},showWave:function(){_homepage.wave_stop=!1;var e=$(".hm-wave"),o=e[0];if(e.length){o.width=core.win.width(),o.height=core.win.height()/3;var i=o.getContext("2d"),n=0,r=200,s=.1,l=0,c=50,d=Math.ceil($(".hm-content.second_").height()/c),f=0;!function e(){if(!_homepage.wave_stop){var t=.3*o.height;i.clearRect(0,0,o.width,o.height),(l+=s)>2*Math.PI&&(l=0),_homepage.scroll_delta>_homepage.cur_scroll_delta?(_homepage.cur_scroll_delta=_homepage.cur_scroll_delta+1,_homepage.cur_scroll_delta>_homepage.scroll_delta_max&&(_homepage.cur_scroll_delta=_homepage.scroll_delta_max)):(_homepage.cur_scroll_delta=_homepage.scroll_delta-_homepage.scroll_delta/20,_homepage.cur_scroll_delta<0&&(_homepage.cur_scroll_delta=0),_homepage.scroll_delta=_homepage.cur_scroll_delta),f+=(_homepage.st-f)/8;for(var a=0;a<d;a++)n=f-c*a,r=o.height/2+Math.sin(.006*n)*(t-_homepage.cur_scroll_delta),i.beginPath(),i.arc(n,r,(o.height/2+t)/(r+o.height/2)*4,0,2*Math.PI),i.fillStyle="#FFFFFF",i.fill();requestAnimationFrame(e)}}()}},unload:function(){_homepage.tl.pause(),core.content.css("overflow","visible"),site.sm_controller.destroy(!1),core.win.off("scroll.homepage"),core.win.off("scroll.wave"),_homepage.wave_stop=!0}},_list={init:function(){console.log("_list init"),rooms.f.init(),_list.initCallback()},initCallback:function(){var e=document.querySelector(".form_commercial");null!==e&&new ValidateForm(e,"/ajax/forms/callorder.php")}};function unleashModals(){document.body.addEventListener("click",function(e){if(e.target.classList.contains("modal__link")){e.preventDefault();var t="";"A"===e.target.nodeName?!1!==(t=e.target.getAttribute("href").replace("#",""))&&""!==t&&document.getElementById(t).classList.add("modal_active"):!1!==(t=e.target.dataset.target)&&""!==t&&document.querySelector('[data-modal="'+t+'"]').classList.add("modal_active")}else(e.target.classList.contains("modal__screen")||e.target.classList.contains("modal__closer"))&&document.querySelector(".modal_active").classList.remove("modal_active")})}var _news={tags:[],init:function(){$(".show-news").click(function(e){e.preventDefault(),_news.showNews($(this).attr("href").replace("#",""))}),_news.$tags=$(".tag-menu a"),_news.$news_all=$(".news-item"),_news.$tags.click(function(e){e.preventDefault();var t=$(this);"all"==t.attr("href").replace("#","")?(_news.$tags.removeClass("active"),t.addClass("active")):(t.toggleClass("active"),_news.$tags.not(t).removeClass("active"),1==_news.$tags.filter("active").length?_news.$tags.eq(0).addClass("active"):_news.$tags.eq(0).removeClass("active")),_news.filterTags()}),$(".news-item-close").click(function(){var e=$(this).closest(".news-item").attr("data-news-head");_news.hideNews(e)})},showNews:function(e){var t=$('.news-item-detail[data-news="'+e+'"]'),a=t.find(".news-item-detail-content"),o=$('[data-news-head="'+e+'"]'),i=o.find(".news-item-text"),n=o.find(".news-item-img"),r=o.find(".news-item-preview .news-item-tags"),s=o.find(".news-item-right");o.find(".news-item-left");o.addClass("open_"),t.addClass("active");var l=a.outerHeight(!0)+10;i.attr("data-h",i.outerHeight(!0)),n.attr("data-h",n.outerHeight(!0)),s.attr("data-h",s.outerHeight(!0)),TweenMax.to(i,.4,{opacity:0,height:0}),TweenMax.to(n,.4,{opacity:0,y:100,scale:1.2}),TweenMax.to(s,.4,{height:0}),TweenMax.to(r,.1,{opacity:0}),TweenMax.to(t,.4,{height:l,visibility:"visible"})},hideNews:function(e){var t=$('.news-item-detail[data-news="'+e+'"]'),a=$('[data-news-head="'+e+'"]'),o=a.find(".news-item-text"),i=a.find(".news-item-right"),n=a.find(".news-item-img"),r=a.find(".news-item-preview .news-item-tags");a.find(".news-item-left");a.removeClass("open_"),TweenMax.to(o,.4,{height:o.attr("data-h")}),TweenMax.to(o,.4,{opacity:1,delay:.2}),TweenMax.to(n,.4,{opacity:1,y:0,scale:1}),TweenMax.to(i,.4,{height:i.attr("data-h")}),TweenMax.to(r,.2,{opacity:1,delay:.4}),TweenMax.to(t,.4,{height:0,onComplete:function(){t.css({visibility:"hidden"})}})},filterTags:function(){_news.tags=[],_news.$tags.filter(".active").each(function(){_news.tags.push($(this).attr("href").replace("#",""))}),_news.$news_all.removeClass("hide_"),1==_news.tags.length&&"all"==_news.tags[0]||_news.$news_all.not('[data-object*="'+_news.tags.join('"], [data-object*="')+'"]').addClass("hide_")}},_objects={init:function(){rooms.f.init(),_list.initCallback(),$(".object-card-gallery").each(function(){if(void 0===this.swiper){var e=$(this);new Swiper(this,{navigation:{nextEl:e.find(".swiper-button-next"),prevEl:e.find(".swiper-button-prev")}})}else this.swiper.update(),this.swiper.slideTo(0)})}},_residential_detail={init:function(){"undefined"==typeof ymaps&&core.content.append('<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"><\/script>');var e=setInterval(function(){"undefined"!=typeof ymaps&&(clearInterval(e),site.loading=!1,ymaps.ready(_residential_detail.loadMap))},100),t=$(".apartments-detail-gallery"),a=(new Swiper(".apartments-detail-gallery",{slidesPerView:1,speed:1e3,loop:!0,parallax:!0,navigation:{nextEl:".apartments-detail-gallery .bottom-next-square",prevEl:".apartments-detail-gallery .bottom-prev-square"},pagination:{el:".apartments-detail-gallery .pagination-fraction",type:"fraction",renderFraction:function(e,t){return'<span class="'+e+'"></span><span></span><span class="'+t+'"></span>'}},on:{slideNextTransitionStart:function(){t.find(".pagination-fraction").addClass("anim-fow_")},slidePrevTransitionStart:function(){t.find(".pagination-fraction").addClass("anim-back_")},slideChangeTransitionEnd:function(){t.find(".pagination-fraction").removeClass("anim-fow_ anim-back_")}}}),$(".apartments-detail-video"));$(".apartments-detail-bt-play").click(function(e){e.preventDefault();var t=a.find("iframe");t.attr("src",t.attr("data-src")),TweenMax.to(a,.4,{opacity:1,display:"block"})}),a.find(".js-window-close").click(function(e){e.preventDefault(),TweenMax.to($(this).closest(".apartments-detail-video"),.4,{opacity:0,display:"none",onComplete:function(){a.find("iframe").attr("src","")}})})},loadMap:function(){var e=[55.793734,37.612811];"undefined"!=typeof resident_coordinates&&resident_coordinates&&(e=resident_coordinates.replace(" ","").split(","));var t=new ymaps.Map($(".apartments-detail-map")[0],{center:e,zoom:16});t.behaviors.disable(["scrollZoom"]),t.setType("yandex#hybrid");var a="/bitrix/templates/sminex_corp/i/pointer-office.png",o=[42,64];"undefined"!=typeof resident_pointer&&resident_pointer&&(a=resident_pointer),"undefined"!=typeof resident_pointer_dim&&1<resident_pointer_dim.length&&(o=resident_pointer_dim);var i=new ymaps.Placemark(e,{},{iconLayout:"default#image",iconImageHref:a,iconImageSize:o,iconImageOffset:[-o[0]/2,-o[1]]});t.geoObjects.add(i)},loadMapOld:function(){var e=[55.793734,37.612811];"undefined"!=typeof resident_coordinates&&resident_coordinates&&(e=resident_coordinates.replace(" ","").split(",")),_residential_detail.center=new google.maps.LatLng(e[0],e[1]);_residential_detail.mapOptions={center:_residential_detail.center,zoom:16,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{position:google.maps.ControlPosition.LEFT_BOTTOM},styles:[{featureType:"administrative.province",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{saturation:-100},{lightness:60},{visibility:"simplified"}]},{featureType:"poi.attraction",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"poi.attraction",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.government",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#b6c54c"},{lightness:40},{saturation:-40}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ef8c25"},{lightness:40}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"all",stylers:[{saturation:-100},{lightness:40},{visibility:"on"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"transit",elementType:"all",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"water",elementType:"all",stylers:[{visibility:"on"},{lightness:30}]}],scrollwheel:!1};var t=new google.maps.Map($(".apartments-detail-map")[0],_residential_detail.mapOptions),a="/bitrix/templates/sminex_corp/i/pointer-office.png";"undefined"!=typeof resident_pointer&&resident_pointer&&(a=resident_pointer);new google.maps.Marker({position:_residential_detail.center,icon:a,map:t})},unload:function(){void 0!==_residential_detail.vimeo_int&&clearInterval(_residential_detail.vimeo_int)}},_residential_list={init:function(){var d=$(".residential-list-header"),f=$(".residential-list-item"),m=$(".residential-list-header-image");if(_residential_list.$video=$("#video"),_residential_list.$video.length&&(_residential_list.$video.currentTime=0,_residential_list.$video[0].pause()),_residential_list.$video.length){var e=_residential_list.$video[0];_residential_list.vint=setInterval(function(){3<=e.readyState&&(clearInterval(_residential_list.vint),e.play(),site.loading=!1)},50),setTimeout(function(){site.loading&&(site.loading=!1,clearInterval(_residential_list.vint),_residential_list.$video.attr("autoplay","autoplay"),_residential_list.$video[0].play())},1e4)}setTimeout(function(){site.loading=!1,_residential_list.$video.length&&(_residential_list.$video[0].play(),clearInterval(_residential_list.vint))},15e3),f.hover(function(){var e=$(this).index(),t=m.eq(e);t.hasClass("static_")||TweenMax.fromTo(t,.8,{opacity:0,scale:1.1,rotationY:10},{opacity:1,scale:1,rotationY:0})},function(){var e=$(this).index(),t=m.eq(e);t.hasClass("static_")||TweenMax.to(t,.6,{opacity:0,scale:1.1,rotationY:10})});var p=new TimelineLite({delay:.4});p.staggerFromTo(f,.6,{opacity:0,y:40,z:30,rotationX:60},{opacity:1,y:0,z:0,rotationX:0},.1),$(".residential-list-item .overlay-link").click(function(e){e.preventDefault();var t=$(this),a=t.attr("href"),o=t.closest(".residential-list-item"),i=o.index(),n=t.closest(".residential-list-item-inner"),r=t.closest(".residential-list-items"),s=o.find(".residential-list-item-active-img"),l=r.parent();TweenMax.to(m.eq(i),.6,{opacity:0}),m.eq(i).addClass("static_"),core.content.css("overflow","hidden");var c=new TimelineLite({delay:.4,onComplete:function(){core.preload_content.empty().append(s).css({display:"block",opacity:1}).find(s).css("transform","none"),site.custom_loading=_residential_list.customPreloadListner,page(a)}});p.staggerFromTo(f.not(o),.3,{opacity:1,y:0,z:0,rotationX:0},{opacity:0,y:0,z:-20,rotationX:-60,margin:0},-.05).set(f.not(o),{width:0,height:0,borderWidth:0}).to(l,.4,{marginLeft:0,width:"100%",left:0}).to(l,.8,{top:0,marginTop:0},"-=.4").to(d,1,{height:0},"-=.8").to(".residential-list-text",1,{height:"100%",paddingTop:core.win.height()},"-=1"),c.to(n,.7,{rotationX:-180,margin:0,borderWidth:0}).set(n,{display:"none"},"-=.5").fromTo(s,.9,{rotationX:180},{rotationX:0},"-=.7").to(o,.6,{width:"100%",height:"100%",left:0,top:0},"-=.8").to(l,.6,{height:"70%"},"-=.7").staggerFromTo(r.find(".residential-slogan span"),.8,{opacity:0,z:100,y:-50,rotationX:40},{opacity:1,z:0,y:0,rotationX:0},.1,"-=.6")})},customPreloadListner:function(){return site.loading=!0,core.content.addClass("loading"),site.loading_int=setInterval(function(){if(!site.loading){clearInterval(site.loading_int);var e=$(".apartments-detail-anim").css({opacity:0});core.content.removeClass("loading").css("overflow","visible"),(new TimelineLite).to(core.preload_content,.2,{opacity:0,display:"none"}).staggerFromTo(e,.8,{opacity:0,y:50},{opacity:1,y:0},.2,"-=.1"),site.custom_loading=!1}},10),10}},noprice_txt="",rooms={ractive_loading:!1,table:null,table_wrapper:null,table_header:null,sw_object:null,sw_floors:null,panel_object:null,panel_floors:null,show_rows:[],filter:{sq:[],price:[],features:[],floor:[],ids:[],profile:[],section:[],object:[],bld:[],fav:0,rooms:[],rent:!1,sale:!1,gab:0},sort:{sec:0,name:0,sq:1,price:0,rooms:0,floor:0}},cart={initialized:!(rooms.f={init:function(){if("undefined"==typeof Ractive||rooms.ractive_loading){if(rooms.ractive_loading||(core.body.append('<script src="/bitrix/templates/sminex_corp/j/ractive.js"><\/script><script src="/bitrix/templates/sminex_corp/j/ractive-transitions-fade.umd.js"><\/script>'),rooms.ractive_loading=!0),"undefined"==typeof Ractive)return void setTimeout(function(){rooms.f.init()},50);rooms.ractive_loading=!1}noprice_txt=mess.noprice_txt,Ractive.DEBUG=!1,rooms.checked=[],rooms.checked_names=[],rooms.selected_cnt=0,rooms.selected_fld=null,rooms.flats_filtered_cnt=null,rooms.floor_select=null,rooms.slider_to_change=null,rooms.fade=null,rooms.panel_wrapper=null,rooms.callbacks=[],rooms.ra={},rooms.data=[],rooms.slider_onchange=!0,rooms.page_loaded=1,rooms.page_try=1,rooms.cnt_to_load=1e4,rooms.loading=!1,rooms.filter_interval=null,rooms.errors_count=0,rooms.all_loaded=!1,rooms.show_rows=[],rooms.template_el=$(".template-output"),rooms.table_wrapper=$(".page-content"),rooms.table=rooms.table_wrapper.find(".tbl-body"),rooms.table_header=$(".flt-tbl-head"),rooms.flats_total_cnt=$(".rooms-total-cnt"),rooms.flats_filtered_cnt=$(".rooms-filtered"),rooms.flats_filtered_nm=$(".rooms-filtered-name"),rooms.flats_filtered_sq=$(".ftc-val-sq"),rooms.flats_filtered_price=$(".ftc-val-price"),rooms.sw_object=$(".filter-bt-object"),rooms.sw_floors=$(".filter-bt-floors"),rooms.panel_object=$(".filter-panel-object"),rooms.panel_floors=$(".filter-panel-floors"),rooms.fade=$(".filter-fade"),rooms.panel_wrapper=$(".filter-panel-wrapper"),rooms.$filter_profile=$(".filter-select-profile"),rooms.$filter_object=$(".filter-select-object"),rooms.$filter_sq=$(".filter-slider-sq"),rooms.$filter_price=$(".filter-slider-price"),rooms.$filter_features=$(".filter-radio-horizontal"),rooms.$filter_container=$(".list-filter-container"),"undefined"!=typeof object&&object&&(rooms.filter.objects=[object]),rooms.f.initFilter(),rooms.table.empty(),rooms.f.initSort(),rooms.f.initLoadMore(),rooms.table.on("mousewheel",function(e){e.stopPropagation()}),core.win.scroll(rooms.f.onscroll),rooms.f.emptyFilter(),rooms.filter.rent="undefined"!=typeof filter_rent&&filter_rent?1:0,rooms.filter.sale="undefined"!=typeof filter_sale&&filter_sale?1:0;var e=$.url().param();for(var t in e)switch(t){case"profile":$.each($.isArray(e[t])?e[t]:[e[t]],function(){var e=rooms.$filter_profile.find('[data-val="'+this+'"]');e.length&&(rooms.$filter_profile.find(".filter-select-list").radioswitch("display",e.index()),rooms.filter.profile.push(this.toString()))});var a=[];rooms.$filter_profile.find(".selected").each(function(){a.push($(this).text())});break;case"features":$.each($.isArray(e[t])?e[t]:[e[t]],function(){var e=rooms.$filter_features.find('[href="#feature-'+this+'"]');e.length&&(rooms.$filter_features.radioswitch("display",e.index()),rooms.filter.features.push(this.toString()))});break;case"object":$.each($.isArray(e[t])?e[t]:[e[t]],function(){var e=rooms.$filter_object.find('[data-val="'+this+'"]');e.length&&(rooms.$filter_object.find(".filter-select-list").radioswitch("display",e.index()),rooms.filter.object.push(this.toString()))});a=[];rooms.$filter_object.find(".selected").each(function(){a.push($(this).text())});break;case"gab":if(1==e[t]){rooms.filter.gab=1;var o=rooms.$filter_profile.find('[data-val="ГАБ"]');o.length&&rooms.$filter_profile.find(".filter-select-list").radioswitch("display",o.index())}break;case"price":if($.isArray(e[t])&&e[t].length){var i=parseInt(e[t][0]),n=parseInt(e[t][1]);i<n&&(rooms.filter.price=[i,n])}break;case"sq":if($.isArray(e[t])&&e[t].length){var r=parseInt(e[t][0]),s=parseInt(e[t][1]);r<s&&(rooms.filter.sq=[r,s])}}for(var l in"undefined"!=typeof session_filter&&$.extend(rooms.filter,session_filter),"undefined"!=typeof session_sort&&$.extend(rooms.sort,session_sort),rooms.filter)switch(l){case"features":$.each(rooms.filter.features,function(){var e=$(".filter-radio-horizontal"),t=e.find('a[href="#feature-'+this+'"]').index();e.radioswitch("display",t)})}for(var l in rooms.sort)1==rooms.sort[l]&&rooms.table_header.find('a[href="#'+l+'"]').addClass("asc"),2==rooms.sort[l]&&rooms.table_header.find('a[href="#'+l+'"]').addClass("desc");rooms.f.applyFilter(),rooms.ra=new Ractive({el:rooms.template_el[0],template:"#objects_template",data:{objects:rooms.data,changeOffersEnding:function(e){return changeEnding("offer",e)},isHidden:function(e,t){return 4<e}},modifyArrays:!1,onupdate:function(){$(".object-card-gallery").each(function(){if(void 0===this.swiper){var e=$(this);new Swiper(this,{navigation:{nextEl:e.find(".swiper-button-next"),prevEl:e.find(".swiper-button-prev")}})}else{(e=$(this)).find(".swiper-lazy-loaded").removeClass("swiper-lazy-loaded"),setTimeout(function(){e[0].swiper.update()},100)}})}}),rooms.f.initEvents()},initEvents:function(){rooms.ra.on("object-click",function(e){var t=$(e.node).closest(".object-card").attr("data-object-id");rooms.filter.object=[t],page($(e.node).attr("data-path").replace("objects","list")+"?"+$.param(rooms.filter))}),rooms.ra.on("room-click",function(e){site.session.come_from_list=!0;var t=$(e.node).attr("data-id");_area_detail.onClick(t)}),rooms.ra.on("showmore",function(e,t){rooms.show_rows.push(t),$(e.node).css("display","none").closest(".areas-table").addClass("open_").find(".areas-table-row").removeClass("hidden_")}),rooms.ra.on("fav",function(e){rooms.ra.set(e.keypath+".fav",e.context.fav?0:1),cart.f.onclick(e.node)}),rooms.ra.on("sort",function(e,t){rooms.f.sort(t,e.node)}),rooms.ra.on("fav-del",function(e){cart.f.del(e.node)}),rooms.ra.on("showtab",function(e){var t=$(e.node),a=t.attr("data-tab-trg"),o=t.closest(".areas-table"),i=o.find(".areas-table-tab").removeClass("active").filter('[data-tab="'+a+'"]').addClass("active");o.find(".areas-table-tabmenu-item").removeClass("active"),t.addClass("active"),"info"==a&&i.find(".object-card-gallery").each(function(){if(void 0===this.swiper){var e=$(this);new Swiper(this,{navigation:{nextEl:e.find(".swiper-button-next"),prevEl:e.find(".swiper-button-prev")}})}else{(e=$(this)).find(".swiper-lazy-loaded").removeClass("swiper-lazy-loaded"),this.swiper.update()}})}),rooms.ra.on("call",function(e){rooms.f.showRequest(e.context)})},sort:function(e,t){var a=rooms.table_wrapper.find(".areas-table-h-col");for(var o in a.removeClass("asc desc"),rooms.sort)o!=e&&(rooms.sort[o]=0);1!=rooms.sort[e]?(rooms.sort[e]=1,$(t).addClass("asc")):(rooms.sort[e]=2,$(t).addClass("desc")),rooms.f.applyFilter()},renderFlatScheme:function(e){$(".flt-tbl-preview").html(e)},showRequest:function(e){request_data.push({id:"message",val:mess.interest_flat+" "+mess.number_sign+" "+e.num+" "+mess.in_section+" "+e.sectionletter+", "+mess.with_square+" "+e.sq+" "+mess.sqm}),site.cbwnd.showWindow()},loadData:function(e){if(console.log("loadData: page "+e),rooms.page_try=e,rooms.loading||rooms.all_loaded)console.log("break: page is loading");else{rooms.table_wrapper.find(".rooms-empty-result").hide(),rooms.table_wrapper.find(".areas-table").removeClass("open_"),rooms.table_wrapper.find(".rooms-loading").show(),rooms.table.addClass("loading"),rooms.loading=!0;var t={page:e,cnt:rooms.cnt_to_load,filter:rooms.filter,sort:rooms.sort};console.log("getJSON"),$.getJSON("/ajax/io/",t,rooms.f.onGetData).fail(rooms.f.onDataError)}},onDataError:function(){if(console.log("onDataError"),rooms.loading=!1,rooms.errors_count++,1<rooms.errors_count)return rooms.errors_count=0,rooms.table_wrapper.find(".rooms-loading").hide(),rooms.table.removeClass("loading"),void rooms.flats_filtered_cnt.html("");rooms.f.loadData(rooms.page_try)},onGetData:function(e){e.count?(rooms.flats_filtered_cnt.html(e.count),rooms.flats_filtered_nm.html(changeEnding("offer",e.count)),rooms.page_loaded=rooms.page_try,1==rooms.page_loaded&&rooms.f.resetFilterMinMax(e.minmax)):(rooms.flats_filtered_cnt.html("0"),rooms.flats_filtered_nm.html(changeEnding("offer",e.count)),rooms.flats_filtered_sq.html(0),rooms.flats_filtered_price.html(0),rooms.table_wrapper.find(".rooms-empty-result").show()),rooms.flats_total_cnt.html(minmax_start.count),1<rooms.page_loaded?rooms.data=$.merge(rooms.data,e.data):rooms.data=e.data,rooms.f.addData(),e.data.length?$(".rent-list-more").show():$(".rent-list-more").hide(),minmax_start&&minmax_start.count>e.count||rooms.filter.rooms.length?($(".js-clear-filter").addClass("filtered"),core.body.addClass("filtered")):rooms.filter.rooms.length||($(".js-clear-filter").removeClass("filtered"),core.body.removeClass("filtered")),(e.count&&e.data.length<20||!e.count)&&(rooms.all_loaded=!0),rooms.table_wrapper.find(".rooms-loading").hide(),rooms.table.removeClass("loading"),console.log("onGetData"),rooms.f.onLoadEnds(e)},addData:function(){console.log("addData: "+rooms.data.length),1==rooms.page_loaded&&setTimeout(function(){},200),rooms.ra.set("objects",rooms.data),rooms.ra.update()},onLoadEnds:function(){console.log("onLoadEnds"),rooms.loading=!1;for(var e=0;e<rooms.callbacks.length;e++)$.isFunction(rooms.callbacks[e])&&rooms.callbacks[e]();rooms.callbacks=[],console.log("finish addData!"),console.log("======================")},onscroll:function(){var e=core.win.scrollTop();5<e&&!rooms.$filter_container.hasClass("manual_")?rooms.$filter_container.addClass("collapsed_"):e<5&&rooms.$filter_container.removeClass("collapsed_ manual_"),e+50+core.win.height()>=core.doc.height()&&rooms.f.onScrollEnds()},onScrollEnds:function(){rooms.f.loadData(rooms.page_loaded+1)},loadPage:function(e){rooms.table.find(".tbl-body").empty(),rooms.f.loadData(e)},applyFilter:function(){console.log("applyFilter"),rooms.filter_interval&&clearInterval(rooms.filter_interval),rooms.all_loaded=!1,rooms.f.loadData(1)},initFilter:function(){$(".list-filter-collapse").click(function(e){e.preventDefault(),rooms.$filter_container.addClass("manual_").toggleClass("collapsed_")}),rooms.f.init_sq_range(),rooms.f.init_price_range(),rooms.f.init_filter_objects(),rooms.f.init_filter_features(),rooms.f.init_filter_profile(),$(".js-clear-filter").click(function(e){e.preventDefault(),rooms.f.resetFilter()}),$(".bt-rent-show-all").click(function(e){e.preventDefault(),rooms.cnt_to_load=1e4,rooms.f.applyFilter()})},init_filter_objects:function(){rooms.$filter_object.find(".filter-select-list").radioswitch({switch_mode:!1,setfunction:function(e,t){var a=t.attr("data-val");rooms.filter.object.push(a),rooms.f.applyFilter()},unsetfunction:function(e,t){if(1==rooms.filter.object.length)rooms.filter.object=[];else{var a=t.attr("data-val"),o=$.inArray(a,rooms.filter.object);-1!=o&&removeArrayItem(rooms.filter.object,o)}rooms.f.applyFilter()}})},init_filter_profile:function(){rooms.$filter_profile.find(".filter-select-list").radioswitch({switch_mode:!0,setfunction:function(e,t){var a=t.attr("data-val");rooms.filter.sq=[],rooms.filter.price=[],rooms.filter.profile="ГАБ"==a?(rooms.filter.gab=1,[]):(rooms.filter.gab=0,[a]),rooms.f.applyFilter()},unsetfunction:function(e,t,a){if(!a){t.attr("data-val");rooms.filter.sq=[],rooms.filter.price=[],rooms.filter.gab=0,rooms.filter.profile=[],rooms.f.applyFilter()}}})},init_filter_features:function(){rooms.$filter_features.radioswitch({switch_mode:!1,setfunction:function(e,t){var a=t.attr("href").replace("#feature-","");"gab"==a?rooms.filter.gab=1:rooms.filter.features.push(a),rooms.f.applyFilter()},unsetfunction:function(e,t){var a=t.attr("href").replace("#feature-","");if("gab"==a)rooms.filter.gab=null;else if(1==rooms.filter.features.length)rooms.filter.features=[];else{var o=$.inArray(a,rooms.filter.features);-1!=o&&removeArrayItem(rooms.filter.features,o)}rooms.f.applyFilter()}}),$('span[data-val="ГАБ"]').click(function(){$('.filter-select-list-item[data-val="ГАБ"]').trigger("click")})},init_price_range:function(){if(rooms.init_minmax_price=minmax.price,rooms.price_input_left=$("#price-range-display-from-field"),rooms.price_input_right=$("#price-range-display-to-field"),rooms.$filter_price.length){var t=rooms.$filter_price[0];noUiSlider.create(t,{start:[minmax?minmax.price[0]:0,minmax&&minmax.price[1]?minmax.price[1]:1e3],connect:!0,range:{min:minmax?minmax.price[0]:30,max:minmax&&minmax.price[1]?minmax.price[1]:1e3}}),t.noUiSlider.on("update",function(e){rooms.price_input_left.val(parseInt(e[0]).formatMoney(0,","," ")),rooms.price_input_right.val(parseInt(e[1]).formatMoney(0,","," "))}),t.noUiSlider.on("set",function(e,t){rooms.slider_onchange&&(rooms.filter.sq=[],rooms.filter.price=e,rooms.slider_to_change="sq",rooms.f.applyFilter())}),rooms.price_input_left.change(function(){var e=parseInt($(this).val().replace(/ /g,""));t.noUiSlider.set([e,null]),$(this).val(parseInt(e.replace(/ /g,"")).formatMoney(0,","," "))}),rooms.price_input_right.change(function(){var e=parseInt($(this).val().replace(/ /g,""));t.noUiSlider.set([null,e]),$(this).val(parseInt(e.replace(/ /g,"")).formatMoney(0,","," "))})}},init_sq_range:function(){if(rooms.init_minmax_square=minmax.sq,rooms.sq_input_left=$("#sq-range-display-from-field"),rooms.sq_input_right=$("#sq-range-display-to-field"),rooms.$filter_sq.length){var e=rooms.$filter_sq[0];noUiSlider.create(e,{start:[minmax?minmax.sq[0]:0,minmax&&minmax.sq[1]?minmax.sq[1]:1e3],connect:!0,range:{min:minmax?minmax.sq[0]:30,"80%":100,max:minmax&&minmax.sq[1]?minmax.sq[1]:1e3}}),e.noUiSlider.on("update",function(e){rooms.sq_input_left.val(e[0]),rooms.sq_input_right.val(e[1])}),e.noUiSlider.on("set",function(e,t){rooms.slider_onchange&&(rooms.filter.price=[],rooms.filter.sq=e,rooms.slider_to_change="price",rooms.f.applyFilter())}),rooms.sq_input_left.change(function(){e.noUiSlider.set(parseFloat($(this).val().replace(/ /g,"")))}),rooms.sq_input_right.change(function(){e.noUiSlider.set([null,parseFloat($(this).val().replace(/ /g,""))])})}},emptyFilter:function(){for(var e in console.log("emptyFilter"),rooms.$filter_features.radioswitch("soft_reset"),rooms.$filter_profile.find(".filter-select-list").radioswitch("soft_reset"),rooms.$filter_profile.find(".filter-select-display").text(rooms.$filter_profile.attr("data-empty-val")),rooms.$filter_object.find(".filter-select-list").radioswitch("soft_reset"),rooms.$filter_object.find(".filter-select-display").text(rooms.$filter_object.attr("data-empty-val")),$(".js-bld-switch").removeClass("on").addClass("off"),$(".js-bld-switch-cnt").text("все"),$(".js-bld-filter-apply").addClass("disabled_"),rooms.filter)rooms.filter.hasOwnProperty(e)&&"sale"!=e&&"rent"!=e&&($.isArray(rooms.filter[e])?rooms.filter[e]=[]:rooms.filter[e]=null);rooms.slider_to_change=null,"undefined"!=typeof session_filter&&(session_filter={})},resetFilter:function(){console.log("resetFilter"),rooms.f.emptyFilter(),rooms.f.applyFilter()},resetFilterMinMax:function(e){console.log("resetFilterMinMax"),minmax=e,minmax.sq[0]=Math.floor(minmax.sq[0]),minmax.sq[1]=Math.ceil(minmax.sq[1]),minmax.floors=minmax.floor;var t=["sq","price"];rooms.slider_to_change&&(t=[rooms.slider_to_change]),rooms.slider_onchange=!1;for(var a=0;a<t.length;a++){var o=$(".filter-slider-"+t[a]);o.length&&o[0].noUiSlider.set(minmax[t[a]])}rooms.slider_onchange=!0;var i=rooms.$filter_object.find(".filter-select-list-item").addClass("disabled_"),n=rooms.$filter_profile.find(".filter-select-list").find(".selected");n.length||(n=rooms.$filter_profile.find(".filter-select-list").find(".filter-select-list-item")),n.each(function(){i.filter('[data-profiles*="'+$(this).attr("data-val")+'"]').removeClass("disabled_")}),1==rooms.filter.gab?$('[data-val="ГАБ"]').addClass("selected"):$('[data-val="ГАБ"]').removeClass("selected")},initSort:function(){rooms.table_header.find(".table-h-cell a").click(function(e){for(var t in e.preventDefault(),rooms.sort)rooms.sort[t]=0;rooms.table_header.find(".table-h-cell a").not(this).removeClass("asc desc");var a=$(this).attr("href").replace("#","");rooms.table_header.find(".table-h-cell i").addClass("visuallyhidden"),$(this).hasClass("asc")?($(this).removeClass("asc").addClass("desc").find("i").removeClass("fa-arrow-down visuallyhidden").addClass("fa-arrow-up"),rooms.sort[a]=2):!$(this).hasClass("desc")&&$(this).hasClass("asc")||($(this).removeClass("desc").addClass("asc").find("i").removeClass("fa-arrow-up visuallyhidden").addClass("fa-arrow-down"),rooms.sort[a]=1),rooms.f.applyFilter()})},initLoadMore:function(){$(".load-more").click(function(e){e.preventDefault(),rooms.f.loadData(rooms.page_loaded+1)})},initOrderForm:function(){$("#bt_order_call").click(function(e){e.preventDefault(),$("#contact-me").trigger("click")}),$("#order_form").ajaxForm({url:"/ajax/forms/flatorder.php",beforeSubmit:function(e,t){var a=!1;for(i in e)e[i].required&&e[i].value.length<3&&(a=!0);if(a)return alert(mess.fill_all_fields),!1},success:function(){alert(mess.message_send_ok),$("#order_form").find("input[name=name], input[name=phone], input[type=hidden]").val(""),$.modal.close()}})}}),ids:[],cart:null,cart_ind:null,table:null,cnt_to_load:4,loading:!1,flats:[],data:[],sort:{name:0,rooms_num:0,sq:1,sec:0,floor:0,price:0}};cart.f={init:function(){cart.cart=$(".popup-favorites"),cart.bg=$(".fav-modal-bg"),cart.table=cart.cart.find(".fav-table"),cart.cart_ind=$(".js-cart-cnt"),cart.cart_bt=$(".js-cart-bt"),cart.header_bt=$(".header-cart"),cart.f.get(),cart.initialized||(cart.cart_bt.click(function(e){e.preventDefault(),cart.f.showCart()}),cart.initialized=!0)},get:function(e,t){var a={ids:t};e&&(a.command=e),$.getJSON("/ajax/flats/cart.php",a,function(e){console.log("data.ids "+e.ids.length),cart.ids=e.ids,cart.f.updateCart()})},initEvents:function(){cart.ra.on("tr-hover",function(e){$(e.node).addClass("hover"),cart.f.tableMover(e.node)}),cart.ra.on("tr-out",function(e){$(e.node).removeClass("hover"),cart.f.tableMout(e.node)}),cart.ra.on("fav",function(e){cart.f.onclick(e.node)}),cart.ra.on("calc",function(e){cart.f.calc(e.node,e.context)})},updateCart:function(){cart.ids.length?(cart.cart_ind.removeClass("empty_").addClass("full"),cart.cart_bt.removeClass("empty_").addClass("full"),$(".favorites .rooms-empty-result").hide()):(cart.cart_ind.removeClass("full").addClass("empty_"),cart.cart_bt.removeClass("full").addClass("empty_"),$(".favorites .rooms-empty-result").show()),cart.ids.length?cart.cart_ind.text(cart.ids.length):cart.cart_ind.text("0");var a=[];$.each(cart.data,function(e,t){-1!=$.inArray(parseInt(t.id),cart.ids)&&a.push(t)}),cart.data=a},del:function(e){var t=$(e);if(t.length){var a=parseInt(t.attr("id").replace(/flat-|fav-/,""));if(a&&-1!=$.inArray(a,cart.ids)){cart.f.get("del",[a]);for(var o=0;o<rooms.data.length;o++)if(rooms.data[o].id==a){rooms.ra.splice("flats",o,1);break}}}},onclick:function(e){var t=$(e);if(t.length){var a=parseInt(t.attr("id").replace(/flat-|fav-/,""));if(a){if(t.toggleClass("checked"),t.hasClass("bt-flat-fav")&&(t.hasClass("checked")?(t.text("В избранном"),$(".favorites-highlight").addClass("show_")):(t.text("В избранное"),$(".favorites-highlight").removeClass("show_"))),-1!=$.inArray(a,cart.ids)){cart.f.get("del",[a]);for(var o=0;o<rooms.data.length;o++)if(rooms.data[o].id==a){rooms.ra.set("rooms."+o+".fav",0);break}}else cart.f.get("add",[a]);cart.header_bt.velocity({translateY:5},{duration:200}).velocity({translateY:0},{duration:200})}}},showCart:function(){page("/flats/favorites/")},close:function(e){e.preventDefault(),request_text="",cart.header_bt.removeClass("open"),cart.bg.fadeOut(),cart.cart.fadeOut()},initSort:function(){cart.table.find("th a").click(function(e){for(i in e.preventDefault(),cart.sort)cart.sort[i]=0;cart.table.find("th a").not(this).removeClass("asc desc");var t=$(this).attr("class").split(" ");$(this).hasClass("desc")||1==t.length?($(this).removeClass("desc").addClass("asc"),cart.sort[t[0]]=1):$(this).hasClass("asc")&&($(this).removeClass("asc").addClass("desc"),cart.sort[t[0]]=2),cart.f.loadData(1)})},loadData:function(e){if(!cart.loading)if(cart.ids.length){console.log("loadData"),cart.table.parent().find(".rooms-loading").show(),cart.loading=!0;var t={ids:cart.ids,sort:cart.sort,cnt:cart.cnt_to_load,page:e};$.getJSON("/ajax/flats/",t,cart.f.onGetData).fail(cart.f.onDataError)}else cart.cart.find(".fav-controls a").addClass("disabled")},onDataError:function(){cart.loading=!1,cart.table.parent().find(".rooms-loading").hide(),console.log("Error!")},onGetData:function(e){cart.loading=!1,cart.table.parent().find(".rooms-loading").hide(),e.count?(cart.data=e.data,cart.f.addData(),cart.cart.find(".controls a").removeClass("disabled")):cart.cart.find(".controls a").addClass("disabled")},addData:function(){console.log("add cart data: "+cart.data.length),cart.ra.set("flats",cart.data),cart.ra.update()},initForm:function(){cart.cart.find(".bt-send").click(function(e){if(e.preventDefault(),$(this).hasClass("disabled")||!cart.table.find("tbody .tbl-first-row").length)return!1;cart.flat_names=[],cart.table.find("tbody .tbl-first-row").each(function(e,t){t=$(t);var a=mess.section+" "+t.find(".table-c-bld").text()+", "+mess.flat+" "+t.find(".table-c-number").text()+" "+mess.with_square+" "+t.find(".table-c-sq").text()+" "+mess.sqm;cart.flat_names.push(a)}),request_data=[{id:"message",val:mess.interest_flats+" "+cart.flat_names.join(";\r\n")}],$(".page-header-phone .js-callback").trigger("click")})},tableMover:function(e){e=$(e),tr_w=e.width(),cont_w=tr_w,e.find(".fav-row-controls-wrapper").css({width:tr_w-26,height:e.find("td").height()}).end().find(".fav-row-controls-bg").stop().fadeIn(300,"easeOutExpo")},tableMout:function(e){(e=$(e)).find(".fav-row-controls-wrapper .fav-row-controls-bg").stop().fadeOut(300,"easeOutExpo")}};var _stdloading={init:function(){var e=$("[data-preload-res]"),t=!1;if(e.length){var a=[];if(e.each(function(){var e=$(this).attr("data-preload-res");e&&a.push(e)}),a){t=!0;var o=new createjs.LoadQueue;o.on("complete",_stdloading.onload),o.loadManifest(a),setTimeout(_stdloading.onload,1e4)}}t||setTimeout(_stdloading.onload,100)},onload:function(){site.loading=!1}},_tags_filter={tags:[],init:function(){_tags_filter.$tags=$(".tag-menu-item"),_tags_filter.$objects=$("[data-object-tag]"),_tags_filter.$tags.click(function(e){e.preventDefault();var t=$(this);"all"==t.attr("href").replace("#","")?(_tags_filter.$tags.removeClass("active"),t.addClass("active")):(t.toggleClass("active"),_tags_filter.$tags.not(t).removeClass("active"),_tags_filter.$tags.filter(".active").length||_tags_filter.$tags.filter('[href="#all"]').addClass("active")),_tags_filter.filterTags()})},filterTags:function(){_tags_filter.tags=[],_tags_filter.$tags.filter(".active").each(function(){_tags_filter.tags.push($(this).attr("href").replace("#",""))}),_tags_filter.$objects.removeClass("hide_"),1!=_tags_filter.tags.length||"all"!=_tags_filter.tags[0]?_tags_filter.$objects.not('[data-object-tag*="'+_tags_filter.tags.join('"], [data-object-tag*="')+'"]').addClass("hide_"):_tags_filter.$objects.filter('[data-object-tag*="hidden"]').addClass("hide_")}},_team={animation_run:!1,init:function(){_team.$detail=$(".team-item-detail"),_team.$place=$(".team-detail-container"),_team.$list=$(".team-list"),_team.$list_items=$(".team-list-item"),_team.$list_items.click(function(e){_team.animation_run||(_team.animation_run=!0,_team.$list_items.filter(".active").length?_team.collapseItem(this):_team.expandItem(this))})},expandItem:function(e){_team.animation_run=!0,_team.$list_items.removeClass("active");var t=$(e).addClass("active");_team.$detail.html(e.innerHTML);var a=t.offset().left-_team.$list.offset().left;new TimelineMax({onComplete:function(){_team.animation_run=!1}}).set(_team.$detail,{width:t.outerWidth(),height:t.outerHeight(),top:t.position().top,left:a}).set(_team.$detail.find(".team-list-item-img"),{width:_team.$detail.width()}).set(_team.$detail,{visibility:"visible"}).to(_team.$detail,.6,{width:960,left:5,ease:Power2.easeInOut},0).to(_team.$detail.find(".team-list-item-img"),.4,{width:340,height:320,marginBottom:10},0).set(_team.$detail.find(".team-list-item-quote,.team-list-item-bio"),{display:"block",opacity:0},0).set(_team.$detail.find(".team-list-item-content"),{position:"absolute",left:360,width:596,top:4},0).set(_team.$detail.find(".team-list-item-quote"),{y:-50},0).set(_team.$detail.find(".team-list-item-bio"),{y:50},0).to(_team.$detail.find(".team-list-item-bio"),.4,{y:0,opacity:1,ease:Expo.easeOut},.4).to(_team.$detail.find(".team-list-item-quote"),.6,{y:0,opacity:1,ease:Expo.easeOut},"-=0.45").to(_team.$detail.find(".team-list-item-quote-line"),.3,{left:20,right:20},"-=0.4").to(_team.$detail.find(".team-list-item-quote-left"),.2,{left:15,opacity:1},"-=0.2").to(_team.$detail.find(".team-list-item-quote-right"),.2,{right:15,opacity:1},"-=0.2").to(_team.$detail.find(".bt-close"),.2,{opacity:1,rotation:135},"-=0.6"),_team.$detail.off("click").on("click",function(){_team.animation_run||_team.collapseItem()})},collapseItem:function(e){_team.animation_run=!0;var t=_team.$list_items.filter(".active"),a=t.offset().left-_team.$list.offset().left,o=new TimelineMax;o.to(_team.$detail.find(".team-list-item-quote-line"),.2,{left:"50%",right:"50%"}).to(_team.$detail.find(".team-list-item-quote-left,.team-list-item-quote-right"),.2,{opacity:0},0).to(_team.$detail.find(".team-list-item-bio"),.2,{y:100,opacity:0},0).to(_team.$detail.find(".team-list-item-quoter"),.2,{y:-100,opacity:1},0).to(_team.$detail.find(".bt-close"),.2,{opacity:0,rotation:0},0).to(_team.$detail.find(".team-list-item-quote"),.2,{y:-100,opacity:0},0).set(_team.$detail.find(".team-list-item-content"),{position:"static",left:"auto",right:"auto",width:"auto",top:"auto"}).set(_team.$detail.find(".team-list-item-quote,.team-list-item-bio"),{display:"none"}).to(_team.$detail,.6,{width:t.outerWidth(),left:a,ease:Power2.easeInOut},0).to(_team.$detail.find(".team-list-item-img"),.2,{width:t.find(".team-list-item-img").width(),height:t.find(".team-list-item-img").height(),marginBottom:16},0).set(_team.$detail,{visibility:"hidden",onComplete:function(){_team.animation_run=!1,_team.$list_items.removeClass("active"),_team.$detail.empty()}}),void 0!==e&&e&&o.call(_team.expandItem,[e])}},_test={start_scroll:!1,color:["#f1eee9","#e9e6df","#dddad3","#e7e4df","#dbd5c9"],st:0,wave_stop:!0,scroll_delta:0,scroll_delta_max:20,cur_scroll_delta:0,init:function(){site.bg_lazy_stop=!0,_test.start_scroll=!1,_test.$intro=$(".hm-intro"),_test.$slogan1=$(".hm-intro-slogan-1"),_test.$slogan2=$(".hm-intro-slogan-2"),_test.$half_overlay=$(".hm-half-overlay"),core.content.css("overflow","hidden"),setTimeout(function(){site.loading=!1,_test.intro()},10),window.addEventListener("orientationchange",function(){window.location.reload()})},intro:function(){$("#circ").attr("d");var e=$("#halfway").attr("d"),t=$("#straight").attr("d");_test.tl=new TimelineMax({onComplete:function(){core.content.css("overflow","visible"),_test.$intro.find(".intro-circle").hide(),setTimeout(_test.setScroll,100),setTimeout(function(){core.win.on("scroll.homepage",_test.onScroll)},150)}}),_test.tl.set("#arrow-scroll-down-l",{drawSVG:"100% 100%"}).set("#arrow-scroll-down-a",{drawSVG:"50% 50%"}).staggerFromTo(_test.$slogan1.find("div"),1.2,{y:"-150%",opacity:0},{y:"0%",opacity:1,ease:Expo.easeOut},.06,0).staggerFromTo(_test.$slogan1.find("span"),1.2,{y:"200%"},{y:"0%",ease:Expo.easeOut},.06,0).staggerFromTo(_test.$slogan2.find("div"),1.2,{y:"60%",opacity:0},{y:"0%",opacity:1},.07,1).staggerFromTo(_test.$slogan2.find("span"),1.2,{y:"-100%"},{y:"0%"},.07,1).set("#circ",{drawSVG:"0%"},0).to("#circ",2,{drawSVG:"100%"},.6).to("#circ",.1,{morphSVG:{shape:e,shapeIndex:0},ease:Power0.linear}).to("#circ",1,{morphSVG:{shape:t,shapeIndex:0},ease:Power1.easeOut}).to(".hm-intro-slogan",1.2,{y:-50},"-=1.8").to(_test.$slogan2.find("span"),.3,{color:"#FFF",ease:Expo.easeOut},"-=.6").to(_test.$slogan1.find("span"),.3,{color:"#FFF",ease:Expo.easeOut},"-=.5").to(".hm-slogan-pleasure",1,{y:20,opacity:1,ease:Power1.easeOut},"-=.6").to("#arrow-scroll-down-l",.4,{drawSVG:"0% 100%"},"-=.6").to("#arrow-scroll-down-a",.4,{drawSVG:"0% 100%"},"-=.1").to(".hm-menu",1.8,{y:.4*-core.win.height(),opacity:1}).to(".hm-content-first",1.8,{y:.4*-core.win.height(),opacity:1},"-=1.8").to(".hm-content-item.first_",1.2,{marginTop:.1*-core.win.height()},"-=1.6")},onScroll:function(){var e=core.win.scrollTop();_test.$sec_headers=$(".hm-sec-header"),_test.$sec_headers_1=_test.$sec_headers.eq(0),_test.start_scroll?0==e&&_test.$intro.hasClass("hide-slogan_")?_test.showIntroHead():0<e&&!_test.$intro.hasClass("hide-slogan_")&&_test.hideIntroHead():(_test.start_scroll=!0,_test.hideIntroHead(),_test.initEvents(),_test.showWave(),_test.start_scroll=!0),0==e?core.header.removeClass("scrolled_"):core.header.addClass("scrolled_"),10<e&&site.bg_lazy_stop&&(site.bg_lazy_stop=!1,site.f.bgLazyLoad())},showIntroHead:function(){console.log("showIntroHead"),void 0===_test.head_tl?(_test.head_tl=new TimelineMax,_test.head_tl.fromTo(_test.$intro.find(".hm-intro-slogan"),.8,{y:100,opacity:0},{y:-50,opacity:1}).fromTo(_test.$intro.find(".hm-slogan-pleasure"),.8,{y:-100,opacity:0},{y:20,opacity:1},0).to(_test.$intro.find("#video"),.4,{opacity:1},0).fromTo(_test.$intro.find(".arrow-scroll-down"),.4,{y:50,opacity:0},{y:100,opacity:1}).fromTo(_test.$intro.find("#arrow-scroll-down-l"),.4,{drawSVG:"0% 100%"},{drawSVG:"0% 100%"},"-=.2").fromTo(_test.$intro.find("#arrow-scroll-down-a"),.4,{drawSVG:"0% 100%"},{drawSVG:"0% 100%"},"-=.1")):_test.head_tl.restart(),_test.$intro.removeClass("hide-slogan_"),_test.$sec_headers_1.hasClass("shown_")&&(_test.$sec_headers_1.removeClass("shown_"),TweenMax.fromTo(_test.$sec_headers_1,.6,{opacity:1,y:"0%"},{opacity:0,y:"-100%"}))},hideIntroHead:function(){console.log("hideIntroHead"),void 0!==_test.head_tl&&_test.head_tl.pause(),_test.$intro.addClass("hide-slogan_"),TweenMax.to(_test.$intro.find(".hm-intro-slogan"),.4,{y:-300,opacity:0}),TweenMax.to(_test.$intro.find(".hm-slogan-pleasure"),.4,{y:-200,opacity:0}),TweenMax.to(_test.$intro.find(".arrow-scroll-down"),.4,{y:0,opacity:0}),_test.$sec_headers_1.hasClass("shown_")||(_test.$sec_headers_1.addClass("shown_"),TweenMax.fromTo(_test.$sec_headers_1,.6,{opacity:0,y:"150%"},{opacity:1,y:"0%"}))},setScroll:function(){$(".hm-content-item").each(function(e){var t=$(this);new ScrollMagic.Scene({triggerElement:this,duration:"300%",triggerHook:.8}).setTween(TweenMax.fromTo(this,1,{y:0},{y:core.html.hasClass("browser-ie")?-200:-350})).on("enter",function(){t.addClass("in-view")}).on("leave",function(){t.removeClass("in-view")}).addTo(site.sm_controller)}),$(".hm-content-text").each(function(){var e=$(this),a=parseInt(e.attr("data-sec")),t=(parseInt(e.attr("data-cnt")),$('.hm-content-section[data-sec-child="'+a+'"]')),o=t.height()+parseInt(t.css("paddingBottom"))+parseInt(t.css("paddingTop"));new ScrollMagic.Scene({triggerElement:this,duration:o-260,triggerHook:.56}).setPin(this,{pushfollowers:!1}).on("leave",function(){console.log("leave sec "+a);var e=_test.$sec_headers.filter("[data-sec="+a+"]");e.removeClass("shown_"),TweenMax.fromTo(e,.6,{opacity:1,y:"0%"},{opacity:0,y:"-200%"})}).on("enter",function(){console.log("enter sec "+a);var e=_test.$sec_headers.filter("[data-sec="+a+"]"),t=e.index();e.hasClass("shown_")||(e.addClass("shown_"),TweenMax.fromTo(e,.4,{opacity:0,y:"150%"},{opacity:1,y:"0%"}),TweenMax.to(_test.$half_overlay,.6,{backgroundColor:_test.color[t]}))}).addTo(site.sm_controller)}),core.win.on("scroll.wave",function(){_test.st=core.win.scrollTop(),_test.scroll_delta=_test.scroll_delta_max})},initEvents:function(){_test.$sec_show_overlay=$(".hm-sec-show-wnd"),_test.$sec_show_img=_test.$sec_show_overlay.find(".sec-show-img"),_test.$sec_show_bg=_test.$sec_show_overlay.find(".sec-show-bg"),_test.$slider=$(".hm-slider"),_test.$sliders=_test.$slider.find(".swiper-slide"),_test.slider={},_test.$slider.each(function(){$(this).attr("data-slider-sec")}),_test.slider=new Swiper(_test.$slider,{speed:1e3,effect:"fade",shortSwipes:!1,navigation:{nextEl:_test.$slider.find(".hm-slider-nav-right"),prevEl:_test.$slider.find(".hm-slider-nav-left")}}),$(".hm-content-item").click(function(e){e.preventDefault();var t=$(this),a=t.find(".hm-content-item-img-inner"),o=a[0].getBoundingClientRect(),i=(t.attr("data-item-sec"),parseInt(t.attr("data-glob-idx"))),n=_test.$slider,r=n.find(".swiper-slide");_test.slider.slideTo(i,0),(new TimelineMax).set(_test.$sec_show_bg,{right:"40%"}).set(_test.$sec_show_overlay,{visibility:"visible",opacity:1}).set(_test.$sec_show_img,{backgroundImage:a.css("backgroundImage"),top:o.top,left:"60%",width:512,height:320}).to(_test.$sec_show_img,.8,{top:0,height:"100%",ease:Expo.easeOut},0).to(_test.$sec_show_img,.7,{left:0,width:"100%",x:0,ease:Expo.easeOut},0).set(n,{visibility:"visible",opacity:1}).set(r.filter(".swiper-slide-active"),{opacity:1}).to(_test.$sec_show_bg,1,{right:20,ease:Expo.easeOut},.4).to(_test.$sec_show_overlay,1,{autoAlpha:0},"-=0.4").set(_test.$sec_show_img,{backgroundImage:""})}).hover(function(){var e=$(this),t=e.find(".circle_"),a=e.find("circle");TweenMax.to(a,.4,{drawSVG:"80% 100%"}),TweenMax.fromTo(t,1,{rotation:0},{rotation:360,repeat:5,ease:Power0.easeNone})},function(){var e=$(this),t=e.find(".circle_"),a=e.find("circle");TweenMax.to(a,.4,{drawSVG:"0% 100%"}),TweenMax.to(t,.4,{rotation:540})}),$(".hm-slider-close").click(function(e){e.preventDefault();var t=$(this).closest(".swiper-slide"),a=t.find(".hm-slider-img"),o=t.find(".hm-slider-info"),i=$(this).closest(".hm-slider"),n=i.find(".swiper-slide"),r=new TimelineMax({onComplete:function(){TweenMax.set(i,{visibility:"hidden",opacity:0}),TweenMax.set(a,{x:"0%"}),TweenMax.set(o,{x:"0%"})}});TweenMax.set(n.not(t),{opacity:0}),r.to(a,1,{x:"100%",ease:Expo.easeOut}).to(o,1,{x:"120%",ease:Expo.easeOut},0)})},changeSection:function(){},showWave:function(){_test.wave_stop=!1;var e=$(".hm-wave"),o=e[0];if(e.length){o.width=core.win.width(),o.height=core.win.height()/3;var i=o.getContext("2d"),n=0,r=200,s=.1,l=0,c=50,d=Math.ceil($(".hm-content.second_").height()/c),f=0;!function e(){if(!_test.wave_stop){var t=.3*o.height;i.clearRect(0,0,o.width,o.height),(l+=s)>2*Math.PI&&(l=0),_test.scroll_delta>_test.cur_scroll_delta?(_test.cur_scroll_delta=_test.cur_scroll_delta+1,_test.cur_scroll_delta>_test.scroll_delta_max&&(_test.cur_scroll_delta=_test.scroll_delta_max)):(_test.cur_scroll_delta=_test.scroll_delta-_test.scroll_delta/20,_test.cur_scroll_delta<0&&(_test.cur_scroll_delta=0),_test.scroll_delta=_test.cur_scroll_delta),f+=(_test.st-f)/8;for(var a=0;a<d;a++)n=f-c*a,r=o.height/2+Math.sin(.006*n)*(t-_test.cur_scroll_delta),i.beginPath(),i.arc(n,r,(o.height/2+t)/(r+o.height/2)*4,0,2*Math.PI),i.fillStyle="#FFFFFF",i.fill();requestAnimationFrame(e)}}()}},unload:function(){_test.tl.pause(),core.content.css("overflow","visible"),site.sm_controller.destroy(!1),core.win.off("scroll.homepage"),core.win.off("scroll.wave"),_test.wave_stop=!0}};
